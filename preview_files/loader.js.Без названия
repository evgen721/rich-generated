(()=>{var __webpack_modules__={554:(e,t,i)=>{var n,r=i.g.crypto||i.g.msCrypto;if(r&&r.getRandomValues){var s=new Uint8Array(16);n=function(){return r.getRandomValues(s),s}}if(!n){var o=new Array(16);n=function(){for(var e=0,t=void 0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}for(var a=[],c=0;c<256;++c)a[c]=(c+256).toString(16).substr(1);function u(e,t){var i=t||0,n=a;return n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]}var l=n(),d=[1|l[0],l[1],l[2],l[3],l[4],l[5]],h=16383&(l[6]<<8|l[7]),p=0,m=0;e.exports={v1:function(e,t,i){var n=t&&i||0,r=t||[],s=void 0!==(e=e||{}).clockseq?e.clockseq:h,o=void 0!==e.msecs?e.msecs:(new Date).getTime(),a=void 0!==e.nsecs?e.nsecs:m+1,c=o-p+(a-m)/1e4;if(c<0&&void 0===e.clockseq&&(s=s+1&16383),(c<0||o>p)&&void 0===e.nsecs&&(a=0),a>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=o,m=a,h=s;var l=(1e4*(268435455&(o+=122192928e5))+a)%4294967296;r[n++]=l>>>24&255,r[n++]=l>>>16&255,r[n++]=l>>>8&255,r[n++]=255&l;var g=o/4294967296*1e4&268435455;r[n++]=g>>>8&255,r[n++]=255&g,r[n++]=g>>>24&15|16,r[n++]=g>>>16&255,r[n++]=s>>>8|128,r[n++]=255&s;for(var f=e.node||d,w=0;w<6;++w)r[n+w]=f[w];return t||u(r)},v4:function(e,t,i){var r=t&&i||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var o=0;o<16;++o)t[r+o]=s[o];return t||u(s)}}},742:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),i=t[0],n=t[1];return 3*(i+n)/4-n},t.toByteArray=function(e){var t,i,s=a(e),o=s[0],c=s[1],u=new r(function(e,t,i){return 3*(t+i)/4-i}(0,o,c)),l=0,d=c>0?o-4:o;for(i=0;i<d;i+=4)t=n[e.charCodeAt(i)]<<18|n[e.charCodeAt(i+1)]<<12|n[e.charCodeAt(i+2)]<<6|n[e.charCodeAt(i+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===c&&(t=n[e.charCodeAt(i)]<<2|n[e.charCodeAt(i+1)]>>4,u[l++]=255&t);1===c&&(t=n[e.charCodeAt(i)]<<10|n[e.charCodeAt(i+1)]<<4|n[e.charCodeAt(i+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s=[],o=16383,a=0,u=n-r;a<u;a+=o)s.push(c(e,a,a+o>u?u:a+o));1===r?(t=e[n-1],s.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],s.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return s.join("")};for(var i=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)i[o]=s[o],n[s.charCodeAt(o)]=o;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function c(e,t,n){for(var r,s,o=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},252:(e,t,i)=>{function n(e,t){var i=e.location.pathname.split("/");for(e.document.cookie=t+"; path=/";i.length>0;)e.document.cookie=t+"; path="+i.join("/"),i.pop()}function r(e){for(var t=e.document.cookie.split("; "),i=0;i<t.length;i++){var r=encodeURIComponent(t[i].split(";")[0].split("=")[0])+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT";n(e,r);for(var s=e.location.hostname.split(".");s.length>0;)n(e,r+"; domain="+s.join(".")),s.shift()}}void 0!==(e=i.nmd(e))&&(e.exports=function(e){return r.bind(e,e)})},187:e=>{"use strict";var t,i="object"==typeof Reflect?Reflect:null,n=i&&"function"==typeof i.apply?i.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};t=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(i,n){function r(i){e.removeListener(t,s),n(i)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",r),i([].slice.call(arguments))}g(e,t,s,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&g(e,"error",t,i)}(e,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,i,n){var r,s,o,u;if(a(i),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),s=e._events),o=s[t]),void 0===o)o=s[t]=i,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[i,o]:[o,i]:n?o.unshift(i):o.push(i),(r=c(e))>0&&o.length>r&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=l.bind(n);return r.listener=i,n.wrapFn=r,r}function h(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):m(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function m(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function g(e,t,i,n){if("function"==typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(s){n.once&&e.removeEventListener(t,r),i(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,l=m(c,u);for(i=0;i<u;++i)n(l[i],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},s.prototype.removeListener=function(e,t){var i,n,r,s,o;if(a(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(r=-1,s=i.length-1;s>=0;s--)if(i[s]===t||i[s].listener===t){o=i[s].listener,r=s;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},746:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)}},242:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h,p:()=>o});var n=i(955),r=i(571);const s="flocktoryLogEnabled",o={ALL:0,WARN:1,ERROR:2,SILENT:3};let a=o.ALL;const c={},u=window.console||{info(){},warn(){},error(){}},l=e=>e.reason instanceof Error&&e.reason.stack&&e.reason.stack.indexOf("flocktory")>-1,d=e=>{const t=`[${e}]`,i=t=>a<t||c[e]<t;return{info:(...e)=>{r.C7&&i(o.WARN)&&u.info(t,...e)},warn:(...e)=>{r.C7&&i(o.ERROR)&&u.warn(t,...e)},error:(e,...n)=>{r.C7&&i(o.SILENT)&&u.error(e,t,...n)},setLevel:t=>{c[e]=t}}};d.setLevel=e=>{a=e},d.enable=()=>{n.Z.set(s,a)},d.disable=()=>{void 0!==n.Z.get(s)&&n.Z.remove(s)},window.addEventListener("unhandledrejection",(e=>{l(e)&&d("onunhandledrejection").error(e.reason)})),window.addEventListener("error",(e=>{l(e)&&d("onerror").error(e.message)}));const h=d},571:(e,t,i)=>{"use strict";let n;function r(){if(n)return n;let e=!0,t=window,i=0;for(;e;){try{t.opener!==t.parent&&t.parent!==t.self&&t.parent.document.body?t=t.parent:e=!1}catch(t){e=!1}i>10&&(e=!1),i++}return n=t,t}function s(){const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);let t=window.screen.width;const i=window.innerWidth;return e&&i>0||(t=i),e&&i>=720&&(t=i),e&&t<=670}function o(){const e=navigator.userAgent;return e.indexOf("Mozilla/5.0")>-1&&e.indexOf("Android ")>-1&&e.indexOf("AppleWebKit")>-1&&-1===e.indexOf("Chrome")}function a(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(){let e,t,i,n,r,s;const o={},a=(window.location.search||"").replace(/^\?/,"").split(/&amp;|&/);for(n=0,r=a.length;n<r;n++){t=a[n],s=t.split("="),e=s[0],i=s[1];try{o[e]=decodeURIComponent(i||"")}catch(e){}}return o}function u(){return String(navigator.userAgent).includes("YaBrowser")}function l(){const{userAgent:e}=navigator,t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),i=!!e.match(/WebKit/i);return t&&i&&!e.match(/CriOS/i)}function d(e){return"[object Number]"==={}.toString.call(e)}function h(e,t){return Object.keys(e).forEach((i=>{t(e[i],i,e)})),e}function p(e,...t){return t.forEach((t=>{null!=t&&Object.keys(t).forEach((i=>{if(null==t)return;const n=t[i];void 0!==n&&(a(n)?a(e[i])?p(e[i],n):e[i]=p({},n):e[i]=n)}))})),e}function m(e,t){for(let i=e.length-1;i>=0;i--)if(t(e[i]))return e[i];return null}function g(e,t,i){let n,r,s,o=null,a=0;const c=i||{leading:!0,trailing:!0},u=function(){a=!1===c.leading?0:Date.now(),o=null,s=e.apply(n,r||[]),o||(n=r=null)};return function(){const i=Date.now();a||!1!==c.leading||(a=i);const l=t-(i-a);return n=this,r=arguments,l<=0||l>t?(o&&(clearTimeout(o),o=null),a=i,s=e.apply(n,r),o||(n=r=null)):o||!1===c.trailing||(o=setTimeout(u,l)),s}}function f(e,t,i){let n;return function(){const r=this,s=arguments,o=i&&!n;clearTimeout(n),n=setTimeout((function(){n=null,i||e.apply(r,s)}),t),o&&e.apply(r,s)}}function w(e){return Object.keys(e).map((t=>[t,e[t]]))}function v(e,t){if(!e)throw new Error("Assert error: "+t)}function y(e,t){return e.reduce(((e,i)=>(e[t(i)?0:1].push(i),e)),[[],[]])}function b(e,t,i){const n=t.split(".");let r=0;const{length:s}=n;for(;null!=e&&r<s;)e=e[n[r++]];return r&&r==s&&null!=e?e:i}function _(e){return e.filter(((t,i)=>e.indexOf(t)===i))}function k(e){return e.filter(Boolean)}function S(e,...t){return t.reduce(((e,t)=>e.filter((e=>t.indexOf(e)>-1))),e)}function E(e,t){return new Promise((i=>setTimeout((()=>i(t)),e)))}function I(e,t){const i=e.replace(/[[\]]/g,"\\$&"),n=new RegExp("[?&]"+i+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function A(e,t=[]){if("object"!=typeof e)return e;if(e&&"object"==typeof e&&e.$value)return e.$value;if(e&&"object"==typeof e&&0===t.length)return null;const{$variable:i}=e,n=t.find((e=>e.id===i));return n?n.value:null}function T(e){const t=Object.keys(e).find((e=>"$value"!==e));return t?{[t]:e[t]}:null}function O(e){let t;try{t=document.querySelector(e)}catch(e){t=null}return t}function C(e){return e.replace(/^(BEFORE|AFTER)\s+/,"")}function P(e){let t="insert";const i=C(e);return/^BEFORE\s+/.test(e)&&(t="before"),/^AFTER\s+/.test(e)&&(t="after"),[t,i]}function L(e=""){return t=>`flockapi:${e}:${t}`}function x(){return/^((?!chrome).)*safari/i.test(navigator.userAgent)}i.d(t,{$W:()=>T,C7:()=>N,Ds:()=>f,F5:()=>R,IT:()=>l,M6:()=>h,N2:()=>D,P2:()=>g,QC:()=>A,RH:()=>p,U2:()=>b,Vs:()=>E,X:()=>w,ak:()=>I,am:()=>O,b3:()=>r,dF:()=>m,eM:()=>L,fr:()=>x,hj:()=>d,hu:()=>v,jV:()=>S,jj:()=>_,kz:()=>C,mx:()=>c,oA:()=>k,s0:()=>o,tq:()=>s,uK:()=>y,vs:()=>u,wZ:()=>P});const N=void 0!==i(955).Z.get("flocktoryLogEnabled"),D=()=>!(!window.dataLayer||"function"!=typeof window.dataLayer.push),R=e=>/\/\/[^/]*api.*\.flocktory\.com\/v2\/loader\.js/.test(e)},40:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _common_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(571),_common_log__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(242);const threshold=500,parseInterval=1500;let integrationElements=[];const flocktorySelector=".i-flocktory",toArray=e=>Array.prototype.slice.call(e),parse=function(actions,shareData,win,flocktory){(0,_common_utils__WEBPACK_IMPORTED_MODULE_0__.hu)(actions&&shareData&&win,"no enough params to parse");const{document}=win;let elements=document.querySelectorAll(flocktorySelector);elements=toArray(elements),elements.forEach((el=>{if(el.flocktoryInited)return;const data=el.dataset,actionName=(data.flAction||"").replace(/-([a-z])/g,(e=>e[1].toUpperCase())),action=actions[actionName],actionData={},actionParams={};toArray(el.attributes).forEach((attr=>{const{name}=attr;if(!/^data-fl-/.test(name))return;let value=el.getAttribute(name),parts=/^data-fl-(.*)$/.exec(name)[1].split("-"),prop;if(!parts||!parts.length)return;if("json"===parts[parts.length-1]){try{value=eval(`(${value})`)}catch(e){try{value=JSON.parse(value)}catch(e){(0,_common_log__WEBPACK_IMPORTED_MODULE_1__.Z)("parser").warn("Bad json in element.",name,value)}}parts.pop()}"params"===parts[0]?(parts=parts.slice(1),prop=actionParams):prop=actionData;let i=0;const l=parts.length;for(;i<l;)i===l-1?prop[parts[i]]=value:prop=prop[parts[i]]=prop[parts[i]]||{},i++})),action?"addData"!==actionName?(actionParams.rootElement=el,flocktory.ready((()=>{const e=(0,_common_utils__WEBPACK_IMPORTED_MODULE_0__.RH)({},actionData,{params:actionParams});el.action=action(e)}))):shareData.addData(actionData):((0,_common_log__WEBPACK_IMPORTED_MODULE_1__.Z)("parser").warn("No actions "+actionName),shareData.addData(actionData)),el.flocktoryInited=!0,integrationElements.push(el)}));const _elements=[];let i=0;const l=integrationElements.length;for(;i<l;){const e=integrationElements[i];win.document.body.contains(e)?_elements.push(e):null!=__guard__(e.action,(e=>e.destroy))&&e.action.destroy(),i++}integrationElements=_elements};function __WEBPACK_DEFAULT_EXPORT__(e,t,i,n){parse(e,t,i,n);const r=(0,_common_utils__WEBPACK_IMPORTED_MODULE_0__.P2)(parse.bind(null,e,t,i,n),threshold);let s;i.document.body&&i.MutationObserver&&(s=new i.MutationObserver(r),s.observe(i.document.body,{subtree:!0,attributes:!1,characterData:!1,childList:!0}));const o=setInterval(r,parseInterval);return{destroy:()=>(clearInterval(o),null!=s&&s.disconnect(),(0,_common_utils__WEBPACK_IMPORTED_MODULE_0__.Vs)(threshold))}}function __guard__(e,t){return null!=e?t(e):void 0}},757:function(e){e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t),i.d(t,"UuidTool",(function(){return s})),i.d(t,"Uuid",(function(){return r}));var n={uuid:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i},r=function(){function e(e){this.id="","string"==typeof e?this.fromString(e):Array.isArray(e)?this.fromBytes(e):this.generate()}return e.fromJson=function(t){if("string"==typeof t&&(t=JSON.parse(t)),!t||!t.id)throw new TypeError("The input cannot be converted to Uuid.");return new e(t.id)},e.prototype.generate=function(){var e=new Array(16).fill(0).map((function(){return 256*Math.random()&255}));return e[6]=79&(64|e[6]),this.fromBytes(e),this},e.prototype.fromBytes=function(e){return this.id=e.map((function(e){return("00"+e.toString(16)).slice(-2)})).join("").replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/,"$1-$2-$3-$4-$5"),this.id=this.toString(),this},e.prototype.toBytes=function(){return(this.id.replace(/-/g,"").match(/.{2}/g)||[]).map((function(e){return parseInt(e,16)}))},e.prototype.fromString=function(e){return this.id=e.trim(),this.id=this.toString(),this},e.prototype.toString=function(){switch(e.stringExportFormat){default:case"lowercase":return this.id.toLowerCase();case"uppercase":return this.id.toUpperCase()}},e.prototype.isValid=function(){return"string"==typeof this.id&&36===this.id.length&&n.uuid.test(this.id)},e.prototype.equals=function(t){return"string"==typeof t&&(t=new e(t)),this.toString()===t.toString()},e.stringExportFormat="lowercase",e}(),s=function(){function e(){}return e.toBytes=function(e){return(new r).fromString(e).toBytes()},e.toString=function(e){return(new r).fromBytes(e).toString()},e.newUuid=function(){return(new r).toString()},e.isUuid=function(e){return(new r).fromString(e).isValid()},e.compare=function(e,t){return new r(e).equals(new r(t))},e}()}])},955:(e,t,i)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}i.d(t,{Z:()=>s});var r=function e(t,i){function r(e,r,s){if("undefined"!=typeof document){"number"==typeof(s=n({},i,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var a in s)s[a]&&(o+="; "+a,!0!==s[a]&&(o+="="+s[a].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+o}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var i=document.cookie?document.cookie.split("; "):[],n={},r=0;r<i.length;r++){var s=i[r].split("="),o=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=t.read(o,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){r(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const s=r}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(242);var t=__webpack_require__(571);const i=(0,e.Z)("system"),n="destroy";function r(e,...t){return{factory:e,params:t,edges:[],_edges:[],instance:null}}function s(e){return e.map((e=>e))}var o,a=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});const c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t}(Array);var u;!function(e){e.HANDSHAKE_REQUEST="HANDSHAKE_REQUEST",e.HANDSHAKE_RESPONSE="HANDSHAKE_RESPONSE",e.DATA_REQUEST="DATA_REQUEST",e.DATA_RESPONSE="DATA_RESPONSE"}(u||(u={}));var l,d,h,p=[u.HANDSHAKE_REQUEST,u.DATA_REQUEST],m=[u.HANDSHAKE_RESPONSE,u.DATA_RESPONSE];!function(e){e.COOKIES="COOKIES",e.LS="LS",e.LS_PER_SITE="LS_PER_SITE"}(l||(l={})),function(e){e.GET_VALUE="GET_VALUE",e.SET_VALUE="SET_VALUE",e.REMOVE_VALUE="REMOVE_VALUE",e.CLEAR="CLEAR",e.CHECK_STORAGE="CHECK_STORAGE"}(d||(d={})),function(e){e.AVAILABLE="AVAILABLE",e.UNAVAILABLE="UNAVAILABLE",e.FULL="FULL",e.UNKNOWN="UNKNOWN"}(h||(h={}));var g={VALIDATION_FIELD_NOT_FOUND:"Mandatory request field(s) not found",VALIDATION_SET_NO_VALUE:'For the "'.concat(d.SET_VALUE,' action "value" must be specified'),VALIDATION_UNSUPPORTED_ACTION:"Unsupported action requested. Must be one of: ".concat(Object.values(d).join(", ")),VALIDATION_INCORRECT_STORAGE:"Incorrect storage provided",VALIDATION_SITE_ID_NOT_FOUND:'For the per-site LS storage the "meta.siteId" field must be specified',STORAGE_NOT_AVAILABLE:"The storage is not available"},f="flocktoryLogEnabled",w="https:"===location.protocol,v="https://api.flocktory.com",y=function(){return Date.now().toString(36)+Math.random().toString(36).substr(2)},b=0;const _=function(e){this.id=y(),this.debugNumber=++b,this.messageType=e};var k=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const S=function(e){function t(t,i,n){var r=e.call(this,t)||this;return r.requestId=i,r.requestDebugNumber=n,r}return k(t,e),t}(_);var E=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const I=function(e){function t(t,i){return e.call(this,u.DATA_RESPONSE,t,i)||this}return E(t,e),t}(S);var A=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const T=function(e){function t(t){var i=this,n=t.name,r=t.value,s=t.expireAt,o=t.action,a=t.storage,c=t.meta;return(i=e.call(this,u.DATA_REQUEST)||this).name=n,i.value=r,i.expireAt=s,i.action=o,i.storage=a,i.meta=c,i}return A(t,e),t.prototype.generateResponse=function(){var e=new I(this.id,this.debugNumber);return e.name=this.name,e.action=this.action,e.storage=this.storage,e.meta=this.meta,e},t.deserialize=function(e){var i=e.id,n=e.debugNumber,r=new t(e);return r.id=i,r.debugNumber=n,r},t}(_);var O=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const C=function(e){function t(t,i){return e.call(this,u.HANDSHAKE_RESPONSE,t,i)||this}return O(t,e),t}(S);var P=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const L=function(e){function t(){return e.call(this,u.HANDSHAKE_REQUEST)||this}return P(t,e),t.prototype.generateResponse=function(){return new C(this.id,this.debugNumber)},t.deserialize=function(e){var i=e.id,n=e.debugNumber,r=new t;return r.id=i,r.debugNumber=n,r},t}(_);var x=function(e,t,i){if(i||2===arguments.length)for(var n,r=0,s=t.length;r<s;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))};const N=function(e){var t=e.id,i=e.name,n=e.value,r=e.action,s=e.storage,o=e.meta,a=[d.CHECK_STORAGE,d.CLEAR].includes(r),c=x(x(x(x([],t?[]:['"id"'],!0),a||i?[]:['"name"'],!0),r?[]:['"action"'],!0),s?[]:['"storage"'],!0).join(", ");if(c)throw new Error("".concat(g.VALIDATION_FIELD_NOT_FOUND,": ").concat(c));if(r===d.SET_VALUE&&!n)throw new Error(g.VALIDATION_SET_NO_VALUE);if(!Object.keys(d).includes(r))throw new Error("".concat(g.VALIDATION_UNSUPPORTED_ACTION,': "').concat(r,'"'));if(!Object.values(l).includes(s))throw new Error(g.VALIDATION_INCORRECT_STORAGE);if(r!==d.CHECK_STORAGE&&s===l.LS_PER_SITE&&!(null==o?void 0:o.siteId))throw new Error(g.VALIDATION_SITE_ID_NOT_FOUND)};var D=__webpack_require__(252),R=__webpack_require__.n(D),V=__webpack_require__(955);const U=function(){function e(){}return e.prototype.doRequestAction=function(e){var t=e.name,i=e.value,n=e.action,r=e.expireAt,s=this.getStatus()===h.AVAILABLE;if(n!==d.CHECK_STORAGE&&!s)throw new Error("".concat(g.STORAGE_NOT_AVAILABLE,": ").concat(this.getName()));switch(n){case d.GET_VALUE:return this.getValue(t);case d.SET_VALUE:this.setValue(t,i,r);break;case d.REMOVE_VALUE:this.removeValue(t);break;case d.CLEAR:this.clear();break;case d.CHECK_STORAGE:return s}},e}();var j=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),F=function(){return F=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},F.apply(this,arguments)},M=864e5;const $=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),t.prototype.getName=function(){return l.COOKIES},t.prototype.getStatus=function(){var e="".concat(t.STATUS_COOKIE_NAME,"_").concat(y()),i=Date.now()+M;try{return this.setValue(e,t.STATUS_COOKIE_VALUE,i),this.getValue(e)===t.STATUS_COOKIE_VALUE?h.AVAILABLE:h.UNAVAILABLE}catch(e){return this.getValue(f)&&console.error("[getStatus]",e),h.UNKNOWN}finally{this.removeValue(e)}},t.prototype.getValue=function(e){return V.Z.get(e)},t.prototype.setValue=function(e,i,n){var r=F({},t.DEFAULT_COOKIES_PARAMS);n&&(r.expires=Math.round((n-Date.now())/M)),V.Z.set(e,i,r)},t.prototype.removeValue=function(e){V.Z.remove(e,t.DEFAULT_COOKIES_PARAMS)},t.prototype.clear=function(){console.log("[clear] Use this method for development purposes only"),R()(window)()},t.STATUS_COOKIE_NAME="CookieStorage_status_test",t.STATUS_COOKIE_VALUE="test",t.DEFAULT_COOKIES_PARAMS=w?{sameSite:"none",secure:!0}:{},t}(U);var W=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();const q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return W(t,e),t.prototype.getName=function(){return l.LS},t.prototype.getStatus=function(){try{this.setValue(t.STATUS_ITEM_KEY,t.STATUS_ITEM_VALUE),this.removeValue(t.STATUS_ITEM_KEY)}catch(e){if("QUOTA_EXCEEDED_ERR"===e.name)return h.FULL;if("NS_ERROR_DOM_QUOTA_REACHED"===e.name)return h.FULL;try{if(0===parseInt(window.localStorage.remainingSpace,10))return h.FULL}catch(e){return V.Z.get(f)&&console.error("[getStatus]",e),h.UNKNOWN}return h.UNAVAILABLE}return h.AVAILABLE},t.prototype.getValue=function(e){return window.localStorage.getItem(e)},t.prototype.setValue=function(e,t){window.localStorage.setItem(e,t)},t.prototype.removeValue=function(e){window.localStorage.removeItem(e)},t.prototype.clear=function(){console.log("[clear] Use this method for development purposes only"),window.localStorage.clear()},t.STATUS_ITEM_KEY="LsStorage_status_test",t.STATUS_ITEM_VALUE="test",t}(U);var z=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),B=function(e){function t(i){var n=e.call(this)||this;n.fullKeyPrefix=t.buildFullKeyPrefix(i);try{n.clearOldValues()}catch(e){V.Z.get(f)&&console.error(e)}return n}return z(t,e),t.buildFullKeyPrefix=function(e){return"".concat(t.STORAGE_KEY_MAIN_PREFIX,":").concat(e,":")},t.prototype.getName=function(){return l.LS_PER_SITE},t.prototype.buildStorageKey=function(e){return"".concat(this.fullKeyPrefix).concat(e)},t.getValueObject=function(e){var t=window.localStorage.getItem(e);if(t)return JSON.parse(t)},t.prototype.clearOldValues=function(){var e=this;Object.keys(window.localStorage).filter((function(t){return t.startsWith(e.fullKeyPrefix)})).forEach((function(e){var i=t.getValueObject(e);if(i){var n=i.expireAt;(n&&n<Date.now()||null===n)&&window.localStorage.removeItem(e)}}))},t.prototype.getValue=function(e){var i=this.buildStorageKey(e),n=t.getValueObject(i);if(n)return n.value?"number"!=typeof n.expireAt||n.expireAt>Date.now()?n.value:void 0:n},t.prototype.setValue=function(e,i,n){var r=this.buildStorageKey(e),s=JSON.stringify({value:i,expireAt:n||Date.now()+t.DEFAULT_EXPIRE_IN,updateTs:Date.now()});window.localStorage.setItem(r,s)},t.prototype.removeValue=function(e){var t=this.buildStorageKey(e);window.localStorage.removeItem(t)},t.prototype.clear=function(){var e=this;Object.keys(window.localStorage).filter((function(t){return t.startsWith(e.fullKeyPrefix)})).forEach((function(e){return window.localStorage.removeItem(e)}))},t.STORAGE_KEY_MAIN_PREFIX="flockapi",t.DEFAULT_EXPIRE_IN=2592e6,t}(q);const H=B;window.addEventListener("message",(function(e){var t=e.data,i=e.origin;if(p.includes(null==t?void 0:t.messageType)&&(window.location.origin===v||i===v)){var n=t.messageType===u.HANDSHAKE_REQUEST?function(e){return L.deserialize(e).generateResponse()}(t):function(e){var t=T.deserialize(e),i=t.generateResponse();try{N(t);var n=t.storage,r=t.meta;if(t.messageType===u.DATA_REQUEST){var s=void 0;switch(n){case l.COOKIES:s=new $;break;case l.LS:s=new q;break;case l.LS_PER_SITE:s=new H(r.siteId)}i.value=s.doRequestAction(t)}}catch(e){i.errorMessage=e.message,i.errorStack=e.stack}return i}(t);window.parent.postMessage(n,i)}}));var K=__webpack_require__(746),G=__webpack_require__.n(K),Z="iframe_flock_data_provider",J="https://api.flocktory.com",Q=V.Z.get(f),Y=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},X=function(e,t){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},ee=function(e){return void 0===e&&(e=0),new Promise((function(t){return setTimeout(t,e)}))},te=function(e,t){return void 0===t&&(t=100),Y(void 0,void 0,void 0,(function(){return X(this,(function(i){switch(i.label){case 0:G()((n=e,Boolean(n)&&"[object Function]"==={}.toString.call(n)),'[waitFor] The "predicate" must be a function'),i.label=1;case 1:return e()?[3,3]:[4,ee(t)];case 2:return i.sent(),[3,1];case 3:return[2]}var n}))}))},ie=function(e,t){G()(e,'[createTimeoutPromise] parameter "originalPromise" not found'),G()("number"==typeof t&&t>0,'[createTimeoutPromise] parameter "timeoutMillis" must be a positive number');var i=new Promise((function(e,i){return setTimeout((function(){i(new Error("Promise timed out after ".concat(t," milliseconds")))}),t)})),n=new Promise((function(e){e(null)}));return Promise.race([e,i]).catch((function(e){return Q&&console.warn(e),n}))},ne=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},re=function(e,t){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};const se=function(){function e(e,t){this.isInitialized=!1,this.isInitializationProgress=!1,G()(e,'[constructor] Mandatory parameter "storage" not found'),G()(Object.values(l).includes(e),'[constructor] Incorrect parameter "storage" provided'),this.storage=e,this.options=t}return e.prototype.createIframe=function(){var t;return ne(this,void 0,void 0,(function(){var i,n;return re(this,(function(r){switch(r.label){case 0:return i=(null===(t=this.options)||void 0===t?void 0:t.iframeUrlCommitHash)?"".concat(this.options.iframeUrlCommitHash,"/"):"",[4,new Promise((function(e){var t,n=document.createElement("iframe");n.id=Z,n.name=Z,n.src="".concat(J,"/v2/provider/").concat(i,"provider.html"),n.width="0",n.height="0",n.style.position="absolute",n.style.top="-2000px",n.style.left="0px",n.onload=function(){return e(null)},t=function(){return document.body.appendChild(n)},G()(t instanceof Function,'[executeBodySafe] parameter "callback" must be a function'),document.body?t():document.addEventListener("DOMContentLoaded",t)}))];case 1:r.sent(),n=!1,r.label=2;case 2:return n?[3,5]:[4,e.send(new L).then((function(){n=!0}))];case 3:return r.sent(),[4,ee(e.CONTINUOUS_HANDSHAKE_INTERVAL)];case 4:return r.sent(),[3,2];case 5:return[2]}}))}))},e.prototype.init=function(t){return void 0===t&&(t=e.CONSUMER_DEFAULT_INIT_TIMEOUT),ne(this,void 0,void 0,(function(){var i,n=this;return re(this,(function(r){return G()(!this.isInitialized,"[init] Consumer already initialized"),G()(!this.isInitializationProgress,"[init] Consumer initialization already in progress"),this.isInitializationProgress=!0,i=function(){return ne(n,void 0,void 0,(function(){return re(this,(function(t){switch(t.label){case 0:return window.flocktory.provider.isInitializationProgress?[4,te((function(){return!window.flocktory.provider.isInitializationProgress}),e.INITIALIZATION_FINISH_WAIT_INTERVAL)]:[3,2];case 1:return t.sent(),[3,4];case 2:return document.getElementById(Z)?[3,4]:(window.flocktory.provider.isInitializationProgress=!0,[4,this.createIframe()]);case 3:t.sent(),window.flocktory.provider.isInitializationProgress=!1,t.label=4;case 4:return this.isInitialized=!0,this.isInitializationProgress=!1,[2]}}))}))},[2,ie(i(),t)]}))}))},e.send=function(t){return ne(this,void 0,void 0,(function(){var i,n,r,s;return re(this,(function(o){switch(o.label){case 0:i=t.id,n=t.debugNumber,s=new Promise((function(s,o){r=function(t){var n=t.data,r=n.messageType,a=n.requestId,c=n.requestDebugNumber,u=n.errorMessage;m.includes(r)&&a===i&&(e.logMessaging(r,c,n),u?o(new Error(u)):s(n))},window.addEventListener("message",r),window.frames[Z].postMessage(t,J),e.logMessaging(t.messageType,n,t)})),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,ie(s,e.POST_MESSAGE_SEND_TIMEOUT)];case 2:return[2,o.sent()];case 3:return r&&window.removeEventListener("message",r),[7];case 4:return[2]}}))}))},e.logMessaging=function(e,t,i){if(Q){var n=p.includes(e)?"--\x3e":"<--";console.log("[js-bro]","".concat(n," (").concat(t,")"),i)}},e.prototype.isStorageAvailable=function(t){var i;return ne(this,void 0,void 0,(function(){var n,r,s;return re(this,(function(o){switch(o.label){case 0:return n=(t||{}).meta,r=n||(null===(i=this.options)||void 0===i?void 0:i.meta),[4,e.send(new T({action:d.CHECK_STORAGE,storage:this.storage,meta:r}))];case 1:return s=o.sent(),[2,Boolean(null==s?void 0:s.value)]}}))}))},e.prototype.getValue=function(t,i){var n,r;return ne(this,void 0,void 0,(function(){var s,o,a,c,u,l;return re(this,(function(h){switch(h.label){case 0:return o=(s=i||{}).expireAt,a=s.meta,c=o||(null===(n=this.options)||void 0===n?void 0:n.expireAt),u=a||(null===(r=this.options)||void 0===r?void 0:r.meta),G()(this.isInitialized,"[getValue] Consumer not initialized"),G()(t,'[getValue] Mandatory parameter "name" not found'),[4,e.send(new T({name:t,action:d.GET_VALUE,expireAt:c,meta:u,storage:this.storage}))];case 1:return[2,null==(l=h.sent())?void 0:l.value]}}))}))},e.prototype.setValue=function(t,i,n){var r,s;return ne(this,void 0,void 0,(function(){var o,a,c,u,l;return re(this,(function(h){return a=(o=n||{}).expireAt,c=o.meta,u=a||(null===(r=this.options)||void 0===r?void 0:r.expireAt),l=c||(null===(s=this.options)||void 0===s?void 0:s.meta),G()(this.isInitialized,"[setValue] Consumer not initialized"),G()(t,'[setValue] Mandatory parameter "name" not found'),G()(i,'[setValue] Mandatory parameter "value" not found'),[2,e.send(new T({name:t,value:i,action:d.SET_VALUE,expireAt:u,meta:l,storage:this.storage}))]}))}))},e.prototype.removeValue=function(t,i){var n,r;return ne(this,void 0,void 0,(function(){var s,o,a,c,u;return re(this,(function(l){return o=(s=i||{}).expireAt,a=s.meta,c=o||(null===(n=this.options)||void 0===n?void 0:n.expireAt),u=a||(null===(r=this.options)||void 0===r?void 0:r.meta),G()(this.isInitialized,"[removeValue] Consumer not initialized"),G()(t,'[removeValue] Mandatory parameter "name" not found'),[2,e.send(new T({name:t,action:d.REMOVE_VALUE,expireAt:c,meta:u,storage:this.storage}))]}))}))},e.prototype.clear=function(t){var i;return ne(this,void 0,void 0,(function(){var n,r;return re(this,(function(s){return n=(t||{}).meta,r=n||(null===(i=this.options)||void 0===i?void 0:i.meta),console.log("[clear] Use clearing for development purposes only"),G()(this.isInitialized,"[clear] Consumer not initialized"),[2,e.send(new T({action:d.CLEAR,storage:this.storage,meta:r}))]}))}))},e.CONSUMER_DEFAULT_INIT_TIMEOUT=1e4,e.POST_MESSAGE_SEND_TIMEOUT=1e3,e.INITIALIZATION_FINISH_WAIT_INTERVAL=50,e.CONTINUOUS_HANDSHAKE_INTERVAL=50,e}();var oe=__webpack_require__(742),ae=__webpack_require__(757),ce=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},ue=function(e,t){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};const le=function(){function e(){this.isInitializationStarted=!1,this.isInitialized=!1}return e.prototype.init=function(e){return void 0===e&&(e=se.CONSUMER_DEFAULT_INIT_TIMEOUT),ce(this,void 0,void 0,(function(){return ue(this,(function(t){switch(t.label){case 0:return G()(!this.isInitialized,"[init] Already initialized"),G()(!this.isInitializationStarted,"[init] Initialization already started"),this.initTimeout=e,this.isInitializationStarted=!0,[4,this._init()];case 1:return t.sent(),this.isInitialized=!0,this.isInitializationStarted=!1,[2]}}))}))},e}();var de=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),he=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},pe=function(e,t){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},me=function(e){function t(i){var n=e.call(this)||this;return n.cookiesConsumer=new se(l.COOKIES),n.lsConsumer=new se(l.LS),n.isCookiesAvailable=!1,n.isLsAvailable=!1,n.tempSessionId=t.generateSessionId(),n.isRespectOldSessionInCookies=!1,n.isRespectOldSessionInCookies=i,n}return de(t,e),t.prototype._init=function(){return he(this,void 0,void 0,(function(){var e,i,n,r,s,o,a,c,u;return pe(this,(function(l){switch(l.label){case 0:return[4,this.cookiesConsumer.init(this.initTimeout)];case 1:return l.sent(),[4,this.lsConsumer.init(this.initTimeout)];case 2:return l.sent(),e=this,[4,this.cookiesConsumer.isStorageAvailable()];case 3:return e.isCookiesAvailable=l.sent(),i=this,[4,this.lsConsumer.isStorageAvailable()];case 4:return i.isLsAvailable=l.sent(),this.isCookiesAvailable||this.isLsAvailable?this.isCookiesAvailable?[4,this.cookiesConsumer.getValue(t.STORAGE_ITEM_NAME)]:[3,6]:[2];case 5:return r=l.sent(),[3,7];case 6:r=null,l.label=7;case 7:return n=r,this.isLsAvailable?[4,this.lsConsumer.getValue(t.STORAGE_ITEM_NAME)]:[3,9];case 8:return o=l.sent(),[3,10];case 9:o=null,l.label=10;case 10:return s=o,a=this.isCookiesAvailable&&n&&(this.isRespectOldSessionInCookies||t.isModernSessionId(n)),c=this.isLsAvailable&&t.isModernSessionId(s),u=a?n:c?s:t.generateSessionId(),!this.isLsAvailable||s&&c||this.lsConsumer.setValue(t.STORAGE_ITEM_NAME,u,{expireAt:t.EXPIRE_AT}),[2]}}))}))},t.isModernSessionId=function(e){return t.NEW_GLOBAL_SESSION_REGEXP.test(e)},t.generateSessionId=function(e){var t=e||ae.UuidTool.newUuid(),i=new ae.Uuid(t);return i=i.toBytes(),i=(i=oe.fromByteArray(i)).replace("==",""),i="v:1|s:".concat(i)},t.prototype.getValue=function(){return he(this,void 0,void 0,(function(){var e,i;return pe(this,(function(n){switch(n.label){case 0:return G()(this.isInitialized,"[getValue] GlobalSession not initialized"),this.isCookiesAvailable?[4,this.cookiesConsumer.getValue(t.STORAGE_ITEM_NAME)]:[3,2];case 1:if((e=n.sent())&&(this.isRespectOldSessionInCookies||t.isModernSessionId(e)))return[2,e];n.label=2;case 2:return this.isLsAvailable?[4,this.lsConsumer.getValue(t.STORAGE_ITEM_NAME)]:[3,4];case 3:return i=n.sent(),[2,t.isModernSessionId(i)?i:this.tempSessionId];case 4:return[2,this.tempSessionId]}}))}))},t.STORAGE_ITEM_NAME="__flocktory-web_session2",t.EXPIRE_AT=(new Date).setFullYear((new Date).getFullYear()+100500),t.NEW_GLOBAL_SESSION_REGEXP=/^v:[\w.-]+\|s:[^\s]+$/,t}(le);const ge=me;const fe=function(){this.isInitializationProgress=!1,this.api={FlockDataConsumer:se,GlobalSession:ge,ACTIONS:d,STORAGES:l}};window.flocktory=window.flocktory||new c,window.flocktory.provider=window.flocktory.provider||new fe;const we=15e3,ve={GET_PRECHECKOUT_APPROVED_CAMPAIGNS:"getPrecheckoutApprovedCampaigns",SAVE_PRECHECKOUT_CAMPAIGN_CLOSED_STATE:"savePrecheckoutCampaignClosedState",UPDATE_STORAGE:"updateStorage",GET_GLOBAL_SESSION_ID:"getGlobalSessionId",GET_COOKIE_VALUE:"getCookieValue"},ye=`["${Object.values({GET:"GET",SET:"SET",UNSET:"UNSET",CLEAR:"CLEAR"}).join('", "')}"]`,be=(0,e.Z)("cors"),_e=(0,e.Z)("performance");function ke(e){let i=[];const n=new se(l.LS_PER_SITE,{meta:e}),r=new se(l.COOKIES,{meta:e}),s=!(0,t.vs)(),o=new ge(s),a={isActionAvailable:e=>i.includes(e),getGlobalSessionId:()=>o.getValue(),getCookieValue:e=>r.getValue(e),updateStorage:(e,t,i,r)=>{const{expireAt:s}=r||{};switch(e){case"get":return n.getValue(t);case"set":return n.setValue(t,i,{expireAt:s});case"unset":return n.removeValue(t);case"clear":return n.clear();default:throw new Error(`Wrong method ${e}. Must be on of ${ye}`)}}};if((0,t.IT)())return a;const c=o.init(we).then((()=>{i.push(ve.GET_GLOBAL_SESSION_ID),_e.info("[cors] globalSession ready",performance.now())})).catch(be.error),u=r.init(we).then((()=>r.isStorageAvailable())).then((e=>{e&&i.push(ve.GET_COOKIE_VALUE),_e.info("[cors] Cookies ready",performance.now())})).catch(be.error),d=n.init(we).then((()=>n.isStorageAvailable())).then((e=>{i=[...i,...e?[ve.SAVE_PRECHECKOUT_CAMPAIGN_CLOSED_STATE,ve.GET_PRECHECKOUT_APPROVED_CAMPAIGNS,ve.UPDATE_STORAGE]:[]],_e.info("[cors] LS ready",performance.now())})).catch(be.error);return(0,t.vs)()?Promise.all([c,u,d]).then((()=>a)):a}const Se=(0,e.Z)("system");class Ee{constructor(e,t){this.sessionId=null,this.storageInstance=null,this.cacheLabelMailRU="timeTrackDSPixelMail",this.cacheLabelWeborama="timeTrackDSPixelWeborama",this.cacheLabelSegmento="timeTrackDSPixelSegmento",this.getCachePeriodDay=()=>Date.now()+864e5,this.sessionId=e,this.storageInstance=t}track(){try{return this.initMailRu(),this.initWeborama(),this.initSegmento(),!0}catch(e){return!1}}initMailRu(){const e=`https://top-fwz1.mail.ru/counter?id=2951107;pid=${this.sessionId}`;this.cachedRequest(e,this.cacheLabelMailRU,this.getCachePeriodDay())}initWeborama(){const e=JSON.stringify({flocktory_id:this.sessionId}),t=["https://wf.frontend.weborama.fr/streampixel/?wamid=7629&",`Wvar=${encodeURIComponent(e)}&`,`d.r=${(new Date).getTime()}`].join("");this.cachedRequest(t,this.cacheLabelWeborama,this.getCachePeriodDay())}initSegmento(){const e=["https://tag.rutarget.ru/tag?event=sync&","partner=flocktory&",`external_visitor_id=${this.sessionId}`].join("");this.cachedRequest(e,this.cacheLabelSegmento,this.getCachePeriodDay())}request(e){const t=document.createElement("iframe");t.setAttribute("sandbox",""),t.referrerPolicy="no-referrer",t.src=e,t.style.display="none",t.style.width="0",t.style.height="0",t.onload=()=>{document.body.removeChild(t)},document.body.appendChild(t)}cachedRequest(e,t,i){this.isCached(t,i).then((t=>t&&this.request(e))).catch((e=>Se.error(e)))}isCached(e,t){const i=this.storageInstance;return i.get(e).then((e=>{const t=parseInt(e||0,10);return!t||Number.isNaN(t)||t<Date.now()})).then((n=>(n&&i.set(e,t),n)))}}const Ie="event",Ae=(0,e.Z)("ga");class Te{static addToDataLayer(e,i,n="flocktory"){(0,t.N2)()?window.dataLayer.push({gaDataLayerEvent:n,eventCategory:e.category,eventAction:e.action,eventLabel:e.label,nonInteraction:e.nonInteraction?1:0}):i&&Ae.warn("GA type dataLayer, but no window.dataLayer")}static trackClassic(e){window._gaq&&window._gaq.push?(window._gaq.push(["_trackEvent",e.category,e.action,e.label,null,e.nonInteraction?1:0]),Te.addToDataLayer(e,!1)):Ae.warn('GA type "classic" but no GA on site')}static trackUniversal(e,t){const{gaTrackingPrefix:i,gaDynamicTracker:n,gaTrackerName:r}=t;if(!window.ga)return void Ae.warn("No window.ga");let s="send";i&&(s=i+"."+s);const o=["event",e.category,e.action,e.label,{nonInteraction:e.nonInteraction}];let a;if(r&&window.ga.getByName&&(a=window.ga.getByName(r)),a&&a.send instanceof Function)a.send(...o);else{if(n&&window.ga.getAll){const e=window.ga.getAll();e&&e[0]&&(s=e[0].get("name")+"."+s)}window.ga(s,...o)}Te.addToDataLayer(e,!1)}static trackDdl(e){window.digitalData&&window.digitalData.events&&window.digitalData.events.push?window.digitalData.events.push({name:"Flocktory Event",category:e.category,action:e.action,label:e.label,nonInteraction:Boolean(e.nonInteraction),source:"Flocktory"}):Ae.warn('GA type "ddl" but no DDL on site')}static trackByType(e,t){const{type:i,gaDataLayerEvent:n}=t;switch(i){case"classic":Te.trackClassic(e);break;case"universal":Te.trackUniversal(e,t);break;case"data_layer":Te.addToDataLayer(e,!0,n);break;case"ddl":Te.trackDdl(e)}}static trackToGa4(e,i){const n={send_to:i.ga4TagId,floc_event_data:JSON.stringify({a:e.action,c:e.category,l:e.label})};if(window.gtag)window.gtag(Ie,"floc_event",n);else{if(!(0,t.N2)())return void Ae.warn("No window.gtag and window.dataLayer");Te.sendThroughDataLayer(Ie,"floc_event",n)}Te.addToDataLayer(e,!1)}static sendThroughDataLayer(){window.dataLayer.push(arguments)}}const Oe=(0,e.Z)("ym");class Ce{static track(e,t){const{ymCounterNumber:i}=t;if(!Ce.checkCounter(i))return;const n={event_category:e.category,event_action:e.action,event_label:e.label,event_time:Date.now()},r={[n.event_action]:JSON.stringify(n)};window.ym(i,"params",{flock_event_data:r})}static checkCounter(e){return window.ym?!!window[`yaCounter${e}`]||(Oe.warn("Incorrect counter number is specified in the cabinet"),!1):(Oe.warn("No window.ym"),!1)}}const Pe=(0,e.Z)("external tracking");class Le{constructor(e,t,i,n){this.trackingSettings=i,this.tracker=e,this.campaignEaEventsStorage=n,this.campaign=t,this.versionId=null!=t.widget?t.widget.versionId:"empty"}_track(e,t){const i=this.getDefaultParams(e,t);let n=this.getCampaignLevelParamsRedefinition(i);const r=function(e,t){const{trackRedefinitions:i}=t,n=t=>t.key.action===e.action;return i.find(n)}(n,this.campaign);n=function(e,t){const i=Object.assign({},e);null!=t&&null!=t.value&&(i.action=t.value.action,i.nonInteraction=1==t.value.nonInteraction);return i}(n,r),this.trackToFlocktory(i,n);const s=!r||r.enabled;null!=this.trackingSettings&&s&&(this.trackToEnabledTrackers(n,this.trackingSettings),Pe.info(`${this.trackingSettings.type} track`,n))}track(e,t){const{campaign:i,campaignEaEventsStorage:n}=this;(i.isGaTrackPerSession||i.isTrackEventPerSession)&&n?n.isFirstEvent(i,e).then((r=>r?(this._track(e,t),n.handleEvent(i,e)):null)).catch((e=>{throw new Error(e)})):this._track(e,t)}getDefaultParams(e,t){return{category:"flocktory-precheckout",action:e,label:this.getDefaultLabel(),nonInteraction:t}}getCampaignLevelParamsRedefinition(e){const t=Object.assign({},e);return this.campaign.trackCategory&&(t.category=this.campaign.trackCategory),this.campaign.trackLabel&&(t.label=this.campaign.trackLabel),"no-show"===t.action&&(this.campaign.noShowLabel&&(t.label=this.campaign.noShowLabel),this.campaign.noShowCategory&&(t.category=this.campaign.noShowCategory),this.campaign.noShowAction&&(t.action=this.campaign.noShowAction)),t}getDefaultLabel(){return this.campaign.groupId?String(this.campaign.groupId):this.campaign.id}trackToFlocktory(e,t){return this.tracker.trackCustomActivity(this.campaign.id,e,t||{})}trackToEnabledTrackers(e,t){const{gaTrackingEnabled:i,ymTrackingEnabled:n,ga4TrackingEnabled:r}=t;i&&Te.trackByType(e,t),n&&Ce.track(e,t),r&&Te.trackToGa4(e,t)}}const xe=(0,t.eM)()("precheckoutTestId"),Ne=(0,e.Z)("precheckout-test"),De=(e,t,i)=>new Le(e,{id:t,trackRedefinitions:[],trackCategory:"test-flocktory-precheckout",abTestEnabled:!1,type:"precheckout",widget:null,triggers:[],inactivity:{}},i);const Re=(0,e.Z)("Storage service");function Ve(e,i){(0,t.hu)(i,"No config for Storage");const{siteId:n}=i;(0,t.hu)(n,"No siteId in Storage config");const r=(0,t.eM)(n),s=e&&e.isActionAvailable(ve.UPDATE_STORAGE),o=e=>{const t=localStorage.getItem(e);return JSON.parse(t&&"undefined"!==t?t:"null")},a=(i,n,o)=>{const a=r(i);if((0,t.hu)(null!=n,`Storage.set ${a}, null value not allowed`),s)return e.updateStorage("set",i,n,o).then((e=>{try{localStorage.setItem(a,JSON.stringify(n))}catch(e){}return e}));try{return localStorage.setItem(a,JSON.stringify(n)),Promise.resolve()}catch(e){return Promise.reject(e)}},c=t=>{const i=r(t);if(s)return e.updateStorage("get",t).then((e=>(void 0===e?localStorage.removeItem(i):localStorage.setItem(i,JSON.stringify(e)),e)));try{return Promise.resolve(o(i))}catch(e){return Promise.reject(e)}},u={},l=(e,t)=>{const i=r(e);if(s){if(u[i])return new Promise(((i,n)=>{setTimeout((()=>{l(e,t).then(i).catch(n)}),1)}));u[i]=!0;try{return c(e).then((n=>{const r=t(n);return a(e,r).then((()=>(u[i]=!1,r)))}))}catch(e){return u[i]=!1,Promise.reject(e)}}try{const e=t(o(i));return localStorage.setItem(i,JSON.stringify(e)),Promise.resolve(e)}catch(e){return Promise.reject(e)}};return{get:c,set:a,update:l,clear:()=>{Re.warn("Use Storage.clear() only for development");for(let e=0,t=localStorage.length;e<t;e++){const t=String(localStorage.key(e));/^flockapi:/.test(t)&&localStorage.removeItem(t)}return s?e.updateStorage("clear"):Promise.resolve()}}}var Ue=__webpack_require__(187),je=__webpack_require__.n(Ue);let Fe;const Me=__webpack_require__.g.crypto||__webpack_require__.g.msCrypto;if(Me&&Me.getRandomValues){const e=new Uint8Array(16);Fe=function(){return Me.getRandomValues(e),e}}if(!Fe){const e=new Array(16);Fe=function(){for(let t,i=0;i<16;i++)0==(3&i)&&(t=4294967296*Math.random()),e[i]=t>>>((3&i)<<3)&255;return e}}let $e=[];for(let e=0;e<256;++e)$e[e]=(e+256).toString(16).substr(1);function We(e,t){let i=t||0;const n=$e;return n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+"-"+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]+n[e[i++]]}const qe=Fe(),ze=[1|qe[0],qe[1],qe[2],qe[3],qe[4],qe[5]];let Be=16383&(qe[6]<<8|qe[7]),He=0,Ke=0;const Ge={v1:function(e,t,i){let n=t&&i||0,r=t||[],s=void 0!==(e=e||{}).clockseq?e.clockseq:Be,o=void 0!==e.msecs?e.msecs:(new Date).getTime(),a=void 0!==e.nsecs?e.nsecs:Ke+1;const c=o-He+(a-Ke)/1e4;if(c<0&&void 0===e.clockseq&&(s=s+1&16383),(c<0||o>He)&&void 0===e.nsecs&&(a=0),a>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");He=o,Ke=a,Be=s,o+=122192928e5;const u=(1e4*(268435455&o)+a)%4294967296;r[n++]=u>>>24&255,r[n++]=u>>>16&255,r[n++]=u>>>8&255,r[n++]=255&u;const l=o/4294967296*1e4&268435455;r[n++]=l>>>8&255,r[n++]=255&l,r[n++]=l>>>24&15|16,r[n++]=l>>>16&255,r[n++]=s>>>8|128,r[n++]=255&s;const d=e.node||ze;for(let e=0;e<6;++e)r[n+e]=d[e];return t||We(r)},v4:function(e,t,i){const n=t&&i||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null);const r=(e=e||{}).random||(e.rng||Fe)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(let e=0;e<16;++e)t[n+e]=r[e];return t||We(r)}},Ze="api.flocktory.com",Je={checkInterval:1e3},Qe=1,Ye={precheckoutShown:"precheckoutShown:",viewedPagesCount:"viewedPagesCount:",pageViewsLog:"pageViewsLog",sessionId:"sessionId",globalSessionId:"__flocktory-web_session2",utmTags:"utmTags",utmTagsHypothetical:"utmTagsHypothetical",pageViewsHolds:"pageViewsHolds:",precheckoutShownLog:"precheckoutShownLog",abTests:"abTests",cart:"cart",precheckoutClosed:"precheckoutClosed",itemsViewLog:"itemsViewLog",categoryViewLog:"categoryViewLog",pushSubscribeLog:"pushSubscribeLog",snapshotMeta:"snapshotMeta",campaignEaEvents:"campaignEaEvents",campaignHitLog:"campaignHitLog",isUserSubscribed:"isUserSubscribed"},Xe=`https://${Ze}`,et="web.com.flocktory.default";const tt={isPushNotificationsSupported:function(){return"safari"in window&&"pushNotification"in window.safari},subscribe:function(e){return e=e||{},new Promise(((t,i)=>{if(!e.safariServiceUrl)return i(new Error("options.safariServiceUrl should be defined"));window.safari.pushNotification.requestPermission(e.safariServiceUrl||Xe,e.safariPushId||et,e.data||{},(e=>{try{t(it(e))}catch(e){i(e)}}))}))},init:function(){const e=window.safari.pushNotification.permission(et);return new Promise(((t,i)=>{try{t(it(e))}catch(e){i(e)}}))}};function it(e){if("granted"===e.permission)return e.deviceToken;if("denied"===e.permission)return null;if("default"===e.permission)return null;throw new Error("Incorrect state")}const nt="safari",rt=tt.isPushNotificationsSupported();class st extends Ue.EventEmitter{constructor(e){super(),this.ip=e.ip,this.emitPushStatus=this.emitPushStatus.bind(this),this.checkPushStatus=this.checkPushStatus.bind(this),this.requestPush=this.requestPush.bind(this),this.siteId=e.siteId,this.uuid=Ge.v4()}emitPushStatus(e){return e.secure=!0,e.supported=rt,e.siteId=this.siteId,e.platform=nt,e.availableOnNewPage=!1,this.emit("pushStatus",e)}checkPushStatus(){rt?"denied"!==Notification.permission?tt.init().then((e=>{e?this.emitPushStatus({subscribed:!0,subscriptionId:e}):this.emitPushStatus({subscribed:!1})})).catch((t=>(0,e.Z)("safari-push-manager").error(t,"SafariPushManager: checkPushStatus error"))):this.emitPushStatus({subscribed:!1,denied:!0}):this.emitPushStatus({subscribed:!1})}requestPush(t){null==t&&(t={});const i=t.campaignId;return tt.init().then((e=>e?null:tt.subscribe({safariServiceUrl:`https://${Ze}/p/push/sites/${this.siteId}`,safariPushId:"web.com.flocktory."+this.siteId,data:{"site-id":String(this.siteId),platform:nt,authenticationToken:`${this.siteId}|${t.sessionId||this.uuid}|${i}|${this.ip}`,userAgent:window.navigator.userAgent,referrerURL:window.location.href}}))).then((e=>(this.emit("pushSystemShown"),this.emitPushStatus({subscribed:!!e,denied:!e,subscriptionId:e})))).catch((t=>(t.code===t.ABORT_ERR&&t instanceof DOMException&&this.emitPushStatus({subscribed:!1,denied:!0}),(0,e.Z)("safari-push-manager").error(t,"SafariPushManager: requestPush error"))))}}const ot=st;function at(){return function(){const e=navigator.userAgent;return"serviceWorker"in navigator&&"showNotification"in ServiceWorkerRegistration.prototype&&"PushManager"in window&&-1===e.indexOf("YaBrowser/15.12.1.6476")&&!/YaBrowser\/[0-9.]+ \(beta\)/.test(e)}()}function ct(){return null==navigator.serviceWorker?Promise.reject("No serviceWorker"):navigator.serviceWorker.ready.then((e=>e.pushManager.getSubscription()))}function ut(e){return e.pushManager.subscribe({userVisibleOnly:!0})}const lt={init:function(e){return e=e||"/flock_push_worker.js",at()&&navigator&&navigator.serviceWorker?navigator.serviceWorker.register(e).then(ct):Promise.reject("Service Worker not supported")},isPushNotificationsSupported:at,subscribe:function(e){const t=e&&e.withGeoLocation||!1;return null==navigator.serviceWorker?Promise.reject("No serviceWorker"):navigator.serviceWorker.ready.then((e=>t&&"default"===window.Notification.permission?navigator.permissions.query({name:"geolocation"}).then((t=>("prompt"===t.state&&navigator.geolocation.getCurrentPosition((()=>{})),window.Notification.requestPermission().then((()=>ut(e)))))):ut(e)))}},{EventEmitter:dt}=je(),ht=lt.isPushNotificationsSupported(),pt="https:"===window.location.protocol;const mt=class extends dt{constructor(e){super(),this.emitPushStatus=this.emitPushStatus.bind(this),this.checkPushStatus=this.checkPushStatus.bind(this),this.requestPush=this.requestPush.bind(this),this.setPushDenied=this.setPushDenied.bind(this),this.setPushSubscribed=this.setPushSubscribed.bind(this),this.openPopup=this.openPopup.bind(this),this.storage=e.storage,this.backend=e.backend,this.checkActivePushSubscription=()=>e.backend.checkActivePushSubscription(),this.workerPath=e.workerPath,this.siteId=e.siteId,this.forcedInsecure=e.forcedInsecure||!1}emitPushStatus(t){const i=Object.assign(Object.assign({},t),{secure:pt,supported:ht,siteId:this.siteId,availableOnNewPage:!pt});return this.emit("pushStatus",i),(0,e.Z)("push").info("Push status",i)}checkPushStatus(t){let i=null;if(t.campaignId&&(i=t.campaignId),!ht)return this.emitPushStatus({subscribed:!1});if(function(){try{if(!window.document.querySelector("link[rel=manifest]")){const e=document.createElement("link");e.setAttribute("href","/manifest.json"),e.setAttribute("rel","manifest");const t=document.querySelector("head");if(null==t)throw new Error("No head");t.appendChild(e)}}catch(t){(0,e.Z)("push").error(t,"Inser manifest error")}}(),"denied"===window.Notification.permission)return this.emitPushStatus({subscribed:!1,denied:!0});return Promise.all([this.checkActivePushSubscription(),pt?lt.init(this.workerPath):null,(()=>this.storage.get("pushDenied"))()]).then((([e,t,n])=>n?this.emitPushStatus({subscribed:!1,denied:!0}):e?this.emitPushStatus({subscribed:!0}):t&&!e?this.attachUserToSession(t,i).then((()=>{this.emitPushStatus({subscribed:!0,subscriptionId:t.endpoint})})):t&&e?this.emitPushStatus({subscribed:!0,subscriptionId:t.endpoint}):this.emitPushStatus({subscribed:!1}))).catch((t=>(this.emitPushStatus({subscribed:!1,error:!0}),(0,e.Z)("push").warn("ChromePushManager: checkPushStatus error",t))))}attachUserToSession(e,t){return this.backend.attachPushToSession(e,t)}requestPush(t){null==t&&(t={campaignId:null,withGeoLocation:!1,subdomain:"",newWindow:null});const i=t.campaignId,n=t.withGeoLocation||!1;return pt?lt.init(this.workerPath).then((e=>e||(this.emit("pushSystemShown"),lt.subscribe({withGeoLocation:n})))).then((e=>{const t=e&&e.endpoint;return t?this.attachUserToSession(e,i).then((()=>this.emitPushStatus({subscribed:!0,subscriptionId:t}))):this.emitPushStatus({subscribed:!1,denied:!0})})).catch((t=>(t.code===t.ABORT_ERR||0===t.code)&&t instanceof window.DOMException?this.emitPushStatus({subscribed:!1,denied:!0}):((0,e.Z)("push").error(t,"ChromePushManager: requestPush error"),this.emitPushStatus({subscribed:!1,error:!0,denied:!0})))):this.openPopup(t)}setPushDenied(e){return this.emitPushStatus({fromNewWindow:e.fromNewWindow,subscribed:!1,denied:!0}),this.storage.set("pushDenied",!0)}setPushSubscribed(e){const t=(n=e=>e.campaignId,null!=(i=e)?n(i):void 0);var i,n;return this.attachUserToSession(e.subscription,t),this.emitPushStatus({fromNewWindow:e.fromNewWindow,subscribed:!0,subscriptionId:e.subscription.endpoint})}openPopup(t){const i=t.campaignId;let n="menubar=no,location=no,resizable=no,scrollbars=no,status=no,";n+=`width=${t.newWindow&&t.newWindow.width||530},`;n+=`height=${t.newWindow&&t.newWindow.height||360},`;n+=`left=${t.newWindow&&t.newWindow.left||300},`;n+=`top=${t.newWindow&&t.newWindow.top||0}`,t.newWindow&&null!=t.newWindow.params&&(n=t.newWindow.params);const r=t.newWindow?t.newWindow.title:"Flocktory push",s=t.newWindow?t.newWindow.url:`https://${t.subdomain}.flocktory.com/u_shaman_adv/push/subdomains/${t.subdomain}/index.html?siteId=${this.siteId}`,o=window.open(s,r,n),a=t=>{let n;if(!/^pusher /.test(t.data))return;try{n=JSON.parse(t.data.slice(7))}catch(e){return}const r=function(){return o.close(),window.removeEventListener("message",a)};switch(n.state){case"subscribed":r(),this.attachUserToSession(n.subscription,i),this.emitPushStatus({fromNewWindow:!0,subscribed:!0,subscriptionId:n.subscription.endpoint});break;case"denied":r(),this.setPushDenied({fromNewWindow:!0}),this.emitPushStatus({fromNewWindow:!0,subscribed:!1,denied:!0});break;case"error":(0,e.Z)("push").error(new Error(n.message)),r(),this.emitPushStatus({fromNewWindow:!0,subscribed:!1,denied:!0})}};return window.addEventListener("message",a)}};const gt=/^((?!chrome).)*safari/i.test(navigator.userAgent)?ot:mt,ft=250,wt=["widgetClose","bannerClick"];class vt{constructor(e,i,n){this.rootElement=null,this.cssClasses={},this._iFrameEventHandlers={},this.resizeInterval=0,this.type="base",this.noClose=!0,this.hasSpinner=!1,this.viewportReachedObserversData=[],this.html=e.html,this.paramWidth=e.params.width,this.optionsWidth=e.width,this.rootElement=i,this.events=new Ue.EventEmitter;const r=document.createElement("div"),s=document.createElement("div");if(this.elements={overlay:r,wrapper:s,closeButton:null,iFrame:null,prevIFrame:null},n(this),r.className+=this.cssClasses.overlay,s.className+=this.cssClasses.wrapper,this._iFrameEventHandlers={resize:this.onResize.bind(this),widgetClose:this.onWidgetClose.bind(this),bannerClick:this.onBannerClick.bind(this),userLogin:this.onUserLogin.bind(this)},this.externalResizeHandler=(0,t.P2)((()=>this.onResize()),50),window.addEventListener("resize",this.externalResizeHandler),this.elements.overlay.appendChild(this.elements.wrapper),this.hasSpinner){const e=document.createElement("div");e.className=this.cssClasses.spinner,this.elements.overlay.appendChild(e)}this.canShow()&&(null!=this.rootElement&&this.rootElement.appendChild(this.elements.overlay),this.initIFrame(this.html))}show(){this.canShow()?setTimeout((()=>{this.showOverlay(),this.showWrapper()}),0):this.events.emit("noShow")}hide(){return this.hideWrapper(),this.hideOverlay()}showWrapper(){!this._wrapperShown&&this._iFrameLoaded&&(this._showEl(this.elements.wrapper),this._wrapperShown=!0)}hideWrapper(){this._hideEl(this.elements.wrapper),this._wrapperShown=!1}showOverlay(){return this._showEl(this.elements.overlay)}hideOverlay(){return this._hideEl(this.elements.overlay)}initIFrame(e){let i;if(this.disposeIframe(),!e)return;const n=e.match("<body [^>]*data-width=['\"]([0-9%px]+)['\"][^>]*>");this.width=i=n&&n[1];const r=this._createIFrame(i);this.elements.iFrame&&(this.elements.prevIFrame=this.elements.iFrame),this.elements.wrapper.appendChild(r);const s=r.contentWindow.document;s.open(),s.write(e),s.close(),this.elements.iFrame=r,this._prevIFrameSize=null,this._iFrameLoaded=!1,this._whenIFrameLoad((()=>{this._iFrameLoaded=!0,this._bindIFrameEvents(),this.elements.overlay.classList.add("flockapi-loaded");let e=100;let i=0;let n;const s=r.contentDocument;if(!s)return;const o=s.body;o&&(o.classList.add("jsapi-v2"),(0,t.tq)()&&o.classList.add("is-mobile"),this._wrapperShown?(n=this.getIFrameSize(),this.onResize(n),this.elements.prevIFrame&&this.elements.prevIFrame.parentNode&&this.elements.prevIFrame.parentNode.removeChild(this.elements.prevIFrame)):(this.showWrapper(),setTimeout((()=>{this._isIframeInBody()&&(n=this.getIFrameSize(),this.onResize(n))}),1)),this.resizeInterval=window.setInterval((()=>{if(!this._isIframeInBody())return void this.clearResizeInterval();const t=this.getIFrameSize();this._equalSizes(n,t)||(this.onResize(t),n=t,i++),(0==e--||i>=2)&&this.clearResizeInterval()}),50),this.afterFrameLoaded())}))}_equalSizes(e,t){return e.width===t.width&&e.height===t.height}afterFrameLoaded(){}getIFrameSize(){const{iFrame:e}=this.elements;return{width:e?this.getIFrameWidth(e,this.width):0,height:e?this.getIFrameHeight(e):0}}getIFrameHeight(e){const t=e.contentDocument;if(!t)return 0;const{body:i}=t;if(!i)return 0;const n=i.offsetHeight||e.contentWindow.outerHeight;return n+10>window.innerHeight?window.innerHeight-10:n}getIFrameWidth(e,i){const n=e.contentDocument;if(!n)return 0;const{body:r}=n;if(!r)return 0;let s=i||r.offsetWidth;if(!s){const e=r.style,t=e.display,i=e.visibility,n=e.position;e.display="block",e.visibility="hidden",e.position="absolute",s=r.offsetWidth,e.display=t,e.visibility=i,e.position=n}if((0,t.tq)()){const i=(0,t.s0)()?e.contentWindow.innerWidth:(0,t.U2)(e,"contentWindow.screen.width",null);s=Math.max(+s||0,i||0,window.innerWidth)}return s}canShow(){return Boolean(this.rootElement&&this.html)}_showEl(e){return e.classList.add("flockapi-display_block"),setTimeout((()=>{e.classList.add("flockapi-show"),setTimeout((()=>{e.classList.add("flockapi-shown")}),ft)}),25)}_hideEl(e){return e.classList.remove("flockapi-shown"),e.classList.remove("flockapi-show"),setTimeout((()=>e.classList.remove("flockapi-display_block")),ft)}_createIFrame(e){const i=window.innerWidth>0?window.innerWidth:window.screen.width,n=(0,t.tq)()?i:this.paramWidth||e||"0px",r=document.createElement("iframe");return r.className="flockapi-wrapper_iframe",r.setAttribute("scrolling","no"),r.setAttribute("frameborder","0"),r.setAttribute("allowTransparency","true"),r.style.display="block",r.style.border="none",r.style.overflow="hidden",r.style.width=String(n),r.style.height="0px",r}_bindIFrameEvents(){let e,t=!1,i=!1;const{iFrame:n}=this.elements;if(null==n)return;try{e=this._iFrameEvents=n.contentWindow.sharedEvents||n.contentWindow.h.shared.events}catch(t){e=this._iFrameEvents=new Ue.EventEmitter}let r=n.contentDocument.querySelectorAll("[role]");if(r=[].slice.call(r),r.length&&r.forEach((n=>{const r=n.getAttribute("role");wt.indexOf(r)>-1&&n.addEventListener("click",(()=>{e.emit?e.emit(r):null!=e.fire&&e.fire(r)})),"widgetClose"===r?t=!0:"bannerClick"===r&&(i=!0)})),t){const{closeButton:e}=this.elements;null!=e&&(e.style.display="none")}else this._addWidgetCloseButton();i||this._subscribeBannerClick(),Object.keys(this._iFrameEventHandlers).forEach((t=>{const i=this._iFrameEventHandlers[t];e.on(t,i)}))}onResize(e){return this.elements.iFrame?(e=e&&Array.isArray(e)?e:this.getIFrameSize(),this._emptySize(e)||this._prevIFrameSize&&this._equalSizes(this._prevIFrameSize,e)?null:(this.optionsWidth&&(e.width=this.optionsWidth),setTimeout((()=>this.events.emit("resize",e)),1),this._prevIFrameSize=e,e)):null}onWidgetClose(){this.noClose||(this.viewportReachedObserversData.forEach((({observer:e})=>e.disconnect())),this.events.emit("widgetClose"),this.hide())}onUserLogin(e){return e||(e={}),this.events.emit("userLogin",{data:{sb:e.sb,user_submitted:e.user_submitted,user:{email:e.email,name:e.name}}})}onBannerClick(){return this.events.emit("bannerClick")}disposeIframe(){return this.clearResizeInterval()}clearResizeInterval(){this.resizeInterval&&(clearInterval(this.resizeInterval),this.resizeInterval=0)}_emptySize(e){return!e.width||!e.height}_addWidgetCloseButton(){if(this.noClose)return;if(this.elements.closeButton)return void(this.elements.closeButton.style.display="block");const e=this.elements.closeButton=document.createElement("div");this.cssClasses.closeButton.split(" ").forEach((t=>e.classList.add(t))),this.elements.wrapper.appendChild(e),e.addEventListener("click",this.onWidgetClose.bind(this))}_subscribeBannerClick(){const{iFrame:e}=this.elements;if(null==e)return;const t=e.contentDocument,i=this._iFrameEvents;i&&i.emit&&t.addEventListener("click",(()=>i.emit("bannerClick")))}_isIframeInBody(){return(0,t.b3)().document.body.contains(this.elements.iFrame)}_whenIFrameLoad(e){let t=!1;const{iFrame:i}=this.elements;if(null==i)return;let n=0;const r=function(){clearInterval(n)},s=()=>{if(t||!this._isIframeInBody()||!i.parentNode)return void r();const{body:n}=i.contentDocument;!t&&n&&(t=!0,r(),e())};"complete"===i.contentDocument.readyState?setTimeout(s,0):i.addEventListener("load",s),n=window.setInterval(s,25)}onViewportReached(e,t){const i=new IntersectionObserver((i=>{const{intersectionRatio:n}=i[0];n>=e&&(t(n),this.offViewportReached(t))}),{threshold:e});this.viewportReachedObserversData.push({callback:t,observer:i}),i.observe(this.elements.wrapper)}offViewportReached(e){const t=this.viewportReachedObserversData.find((t=>t.callback===e));t&&t.observer.disconnect()}}class yt extends vt{constructor(e){const i=(0,t.b3)().document.body;super(e,i,(t=>{t.stdMargin=5,t.type="popup",t.noClose=!1,t.hasSpinner=!0,t.cssClasses={overlay:"flockapi-overlay flockapi-overlay_popup flockapi-overlay_widget",wrapper:"flockapi-wrapper flockapi-wrapper_popup flockapi-wrapper_widget",closeButton:"flockapi-closebutton flockapi-closebutton_popup",spinner:"flockapi-spinner flockapi-spinner_popup"};const{overlay:i}=t.elements;null!=e.background&&(i.style.background=e.background)})),this.stdMargin=5,this.type="popup",this.noClose=!1,this.hasSpinner=!0,this.cssClasses={overlay:"flockapi-overlay flockapi-overlay_popup flockapi-overlay_widget",wrapper:"flockapi-wrapper flockapi-wrapper_popup flockapi-wrapper_widget",closeButton:"flockapi-closebutton flockapi-closebutton_popup",spinner:"flockapi-spinner flockapi-spinner_popup"}}onResize(e){let i,n;if(!this.elements.iFrame)return;const r=(0,t.b3)(),s=r.innerHeight,o=r.innerWidth,{overlay:a,iFrame:c,wrapper:u}=this.elements;if(null==c)return;const l=this.getIFrameSize();let{height:d}=l;const h=e=>((0,t.tq)()&&this.stdMargin||Math.max((s-parseInt(`${e}`,10))/2-10,30))+"px";if(e){if(e=e&&Array.isArray(e)?e:l,this._emptySize(e)||this._prevIFrameSize&&this._equalSizes(this._prevIFrameSize,e))return;this.optionsWidth&&(e.width=this.optionsWidth),i=h(e.height),({width:n}=e),({height:d}=e),setTimeout((()=>this.events.emit("resize",e)),1)}else if(Number(l.width)>o){n=o;const e=c.contentDocument,t=e.querySelector("html");t&&t.classList.add("is-mobile");const i=e.querySelector("body");i&&i.classList.add("is-mobile")}else i=h((e=l).height),({width:n}=e),({height:d}=e);n=n||0,d=d||0,i=i||0;const p=Number.isNaN(n)?String(n):n+"px",m=Number.isNaN(d)?String(d):d+"px",g=Number.isNaN(i)?String(i):i+"px";c.style.width=p,c.style.height=m,u.style.width=p,u.style.height=m,u.style.marginTop=g,u.style.marginBottom=g,a.style.overflowY="auto",this._prevIFrameSize={width:n,height:d}}}class bt extends vt{constructor(e){super(e,e.container,(t=>{t.type="embedded",t.rootElement=e.container,t.cssClasses={overlay:"flockapi-overlay flockapi-overlay_embedded flockapi-overlay_widget",wrapper:"flockapi-wrapper flockapi-wrapper_embedded flockapi-wrapper_widget",closeButton:"flockapi-closebutton flockapi-closebutton_embedded",spinner:"flockapi-spinner flockapi-spinner_embedded"}})),this.type="embedded"}onResize(e){const t=super.onResize(e);if(t){let{width:e,height:i}=t;Number.isNaN(e)||(e+="px"),Number.isNaN(i)||(i+="px"),this.elements.overlay.style.width=String(e),this.elements.overlay.style.height=String(i),this.elements.wrapper.style.width=String(e),this.elements.wrapper.style.height=String(i);const{iFrame:n}=this.elements;null!=n&&(n.style.width=String(e),n.style.height=String(i))}}getIFrameWidth(e,t){const i=e.contentDocument;if(!i)return 0;const{body:n}=i;if(!n)return 0;let r=t||n.offsetWidth;if(!r){const e=n.style,t=e.display,i=e.visibility,s=e.position;e.display="block",e.visibility="hidden",e.position="absolute",r=n.offsetWidth,e.display=t,e.visibility=i,e.position=s}return r}}const _t=(0,e.Z)("widget");function kt(e){const i=e.params&&e.params.el;if("popup"===i)return new yt(e);if("inner"===i||""===i)e.container=e.rootElement;else if("[object String]"===Object.prototype.toString.call(i)){const[n,r]=(0,t.wZ)(i);let s=document.querySelector(r);if(null!=s){const e=s.parentNode;if("before"===n){const t=document.createElement("span");null!=e&&e.insertBefore(t,s),s=t}if("after"===n&&null!=e){const t=document.createElement("span");null!=s&&e.insertBefore(t,s.nextSibling),s=t}}else _t.warn("no container "+r);e.container=s}else e.container=i;return new bt(e)}var St=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const Et=.7,It=/iPad; CPU OS 7/.test(navigator.userAgent),At=(0,e.Z)("actions");function Tt(e,i,n,r,s,o){return(0,t.hu)(s&&o,"Actions args"),{exchange:function(e){s.exchangeBanner({name:(0,t.U2)(e,"user.name",null),email:(0,t.U2)(e,"user.email",null),spot:(0,t.U2)(e,"spot",null)}).then((t=>{const i=kt({params:{el:t.selector,trigger:"auto"},html:t.html,noClose:!0,rootElement:e.params.rootElement});i.onViewportReached(Et,(()=>{s.trackExchangeBanner(t.loginData)})),i.canShow()&&(i.show(),window.dataLayer&&window.dataLayer.push({event:"fl_exchange_banner",el:t.selector,html:t.html}))})).catch((()=>{}));const{params:n}=e,r=St(e,["params"]);i.addData(r)},postcheckout:function(e){s.postcheckout(e,o.getUtmTags()).then((e=>{It||setTimeout((()=>{kt({params:{el:e.el},html:e.html,background:e.background}).show()}),e.timeout)})).catch((e=>{At.warn(e)})),i.addData({user:e.user}),i.cart.reset()},trackItemView(t){i.addItemView(t),e.trackItemView(t)},trackCategoryView(t){i.addData(t),e.trackCategoryView(t)},fireEvent(e){n.fireEvent(e)},getData:()=>i.getData(),addData:e=>i.addData(e),trigger:e=>new r.Trigger(e),addToCart(e){i.cart.addItems(e),n.fireEvent({event:"flock_api_add_to_cart",noTrack:!0})},removeFromCart:e=>i.cart.removeItems(e),updateCart:e=>i.cart.update(e),addToFavorites:e=>i.favorites.addItems(e),removeFromFavorites:e=>i.favorites.removeItems(e),updateFavorites:e=>i.favorites.update(e),trackGoalReached:t=>e.trackGoalReached(t),attachToProfile(e,t){i.compareSnapshotMetaByPart(e.data).then((n=>{function r(){i.addMeta(e.data),t&&t()}n?r():s.attachToProfile(e.data).then(r)}))},createPushManager({options:e,callback:t}){t(new gt(e))}}}var Ot=__webpack_require__(40);function Ct(t){const i={utma:{},utmb:{},utmc:{},utmz:{}};if(!t)return i;try{t.replace(/(?:^| |;)__(utm[^;$]*)/g,((e,t)=>{const n=t.slice(0,4),r=t.slice(5),s=r.split("."),o=i[n];if(o)if("utma"===n)o.domainHash=s[0],o.userId=s[1],o.initialVisitTs=s[2]&&Number(s[2]),o.previousVisitTs=s[3]&&Number(s[3]),o.currentVisitTs=s[4]&&Number(s[4]),o.pageViews=s[5]&&Number(s[5]);else if("utmb"===n)o.domainHash=s[0],o.pageViews=s[1]&&Number(s[1]),o.outboundClick=s[2]&&Number(s[2]),o.currentVisitTs=s[3]&&Number(s[3]);else if("utmc"===n)o.domainHash=s[0];else if("utmz"===n){o.domainHash=Number.isNaN(s[0])?void 0:s[0],o.lastCookiesUpdateTs=s[1]&&Number(s[1]),o.sessionCounter=s[2]&&Number(s[2]),o.resourceCounter=s[3]&&Number(s[3]);const e=r.slice(r.indexOf("utm"));e&&e.split("|").forEach((e=>{e=e.split("=");try{o[e[0]]=__webpack_require__.g.unescape(/^\(.*\)$/.test(e[1])?e[1].replace(/^\(?(.*?)\)?$/,"$1"):e[1])}catch(t){o[e[0]]=e[1]}}))}}))}catch(t){(0,e.Z)("ga-cookie-parser").error(t)}return i}const Pt={PAGE:"session.page_visit",ITEM:"customer.item_visit",CATEGORY:"customer.category_visit"},Lt={ADD_ITEM:"customer.add_to_cart",REMOVE_ITEM:"customer.remove_from_cart"},xt={ADD_ITEM:"customer.add_to_favorites",REMOVE_ITEM:"customer.remove_from_favorites"},Nt={REACHED:"goal.tracked"};class Dt{constructor(e,i,n){this.trackCategoryView=this.trackCategoryView.bind(this),this._clearObject=this._clearObject.bind(this),this.trackAddToCart=this.trackAddToCart.bind(this),this.trackRemoveFromCart=this.trackRemoveFromCart.bind(this),this.trackAddToFavorites=this.trackAddToFavorites.bind(this),this.trackRemoveFromFavorites=this.trackRemoveFromFavorites.bind(this),this.trackGoalReached=this.trackGoalReached.bind(this),(0,t.hu)(i&&e),this.state=e,this.backend=n,this.settings=i}getDefaults(){return{links:{site:this.settings.siteId},payload:{url:window.location.href}}}trackPageView(){const e=Ct(String.prototype.slice.call(document.cookie)),t=this.state.getUtmTags(),i=this.state.getHypotheticalUtmTags(),n={action:Pt.PAGE,payload:{resolution:`${window.screen.availWidth}x${window.screen.availHeight}`,ga:{utmcsr:e.utmz.utmcsr||t.source,utmccn:e.utmz.utmccn||t.campaign,utmcmd:e.utmz.utmcmd||t.medium,utmctr:e.utmz.utmctr,utmcct:e.utmz.utmcct,h_utmcsr:i.source,h_utmccn:i.campaign,h_utmcmd:i.medium,previous_visit_ts:e.utma.previousVisitTs,current_visit_ts:e.utma.currentVisitTs,initial_visit_ts:e.utma.initialVisitTs,pageviews:e.utma.pageViews}}};this.track(n)}trackItemView(e){const{label:t}=e.item,i=this._clearObject(e.item||{}),{id:n,name:r,url:s,picture:o,price:a,available:c,category_id:u,vendor:l}=i,d="boolean"==typeof c||"true"===c||"false"===c,h={action:Pt.ITEM,links:{yandex_offer:Vt(e.item,(e=>e.id))},payload:Object.assign(Object.assign(Object.assign({id:n,name:r,url:s,picture:o,price:a,vendor:l},d?{available:String(c)}:{}),u?{category_id:u}:{}),t?{labels:t}:{})};this.track(h)}trackCategoryView(e){const t={action:Pt.CATEGORY,links:{yandex_category:Vt(e.category,(e=>e.id))}};this.track(t)}_clearObject(e){const t={};return Object.keys(e).forEach((i=>{const n=e[i];["string","number","boolean"].indexOf(typeof n)>-1&&(t[i]=n)})),t}trackAddToCart(e){const t=this._clearObject(e),i={action:Lt.ADD_ITEM,links:{yandex_offer:Vt(e,(e=>e.id))||null},payload:{count:Vt(e,(e=>e.count))||Vt(e,(e=>e.quantity))||null,custom_data:t}};this.track(i)}trackRemoveFromCart(e){const t=this._clearObject(e),i={action:Lt.REMOVE_ITEM,links:{yandex_offer:Vt(e,(e=>e.id))||null},payload:{count:Vt(e,(e=>e.count))||Vt(e,(e=>e.quantity))||null,custom_data:t}};this.track(i)}trackAddToFavorites(e){const t=this._clearObject(e),i={action:xt.ADD_ITEM,links:{yandex_offer:Vt(e,(e=>e.id))||null},payload:{custom_data:t}};this.track(i)}trackRemoveFromFavorites(e){const t=this._clearObject(e),i={action:xt.REMOVE_ITEM,links:{yandex_offer:Vt(e,(e=>e.id))||null},payload:{custom_data:t}};this.track(i)}trackGoalReached(e){const t=e.goal;if(!t.id)return;const i=Ct(String.prototype.slice.call(document.cookie)),n=this.state.getUtmTags(),r={action:Nt.REACHED,payload:{resolution:`${window.screen.availWidth}x${window.screen.availHeight}`,goal:`${t.id}`.substring(0,10),ga:{utmcsr:i.utmz.utmcsr||n.source,utmccn:i.utmz.utmccn||n.campaign,utmcmd:i.utmz.utmcmd||n.medium}}};this.track(r)}track(e){const i=(0,t.RH)({},e,this.getDefaults());this.backend.ultimate(i)}trackCustomActivity(e,t,i={}){const n=this.state.getUtmTags(),r=Object.assign(Object.assign({url:window.location.href},t),i);Object.keys(n).forEach((e=>{r[`utm_${e}`]=n[e]}));const s=Object.keys(r).map((e=>({key:String(e),value:String(r[e])})));this.backend.customActivity(s,e)}trackCustomEvent(e){this.backend.customEvent(e)}}function Rt(e,t,i){return new Dt(e,t,i)}function Vt(e,t){return null!=e?t(e):void 0}const Ut=(0,e.Z)("trigger-manager"),jt=(0,e.Z)("performance");class Ft{constructor(e,t,i,n,r,s){this.behaviorWatcher=t,this.setupApiDataStorage=s,this.state=r,this.storage=e,this.triggers=[],this.behaviorListeners={check:e=>{jt.info("trigger check",performance.now()),e.behaviorWatcher=t,e.behaviorStorage=i,e.documentWatcher=n,this._checkTriggers(e)}},this.inCheckingProcess=!1,this.behaviorWatcher.events.on("check",this.behaviorListeners.check)}push(e){this.triggers.push(e)}removeTriggerByCampaignId(e){const t=this.triggers.find((t=>t.campaign.id===e));t&&(t.markExpired(),this.triggers.splice(this.triggers.indexOf(t),1))}removeAllTriggers(){this.triggers.forEach((e=>e.markExpired())),this.triggers=[]}destroy(){this.behaviorWatcher.events.removeListener("check",this.behaviorListeners.check)}_checkTriggers(e){if(this.inCheckingProcess)return void Ut.warn("Try to check triggers before previous check ends");this.inCheckingProcess=!0;const t=this.triggers.map((t=>t.check(e))).filter((e=>e));Promise.all(t).then((e=>this.__checkResults(e))).then((()=>{this.inCheckingProcess=!1,this.behaviorWatcher.events.emit("end_check_triggers")})).catch((e=>{this.inCheckingProcess=!1,Ut.error(e,"Check trigger")}))}__checkResults(e){const t=[],i=[];return e.forEach((e=>{e[0]&&(t.push(e[1]),i.push(e[1].campaign.id))})),this.state.getApprovedCampaigns(i).then((e=>{if(this.setupApiDataStorage.determineExpirationAndFireEventIfNecessary())return;let i=e;const n=this.setupApiDataStorage.getSetupApiData();if(n.campaigns){const t=n.campaigns.map((({id:e})=>e));i=e.filter((e=>t.includes(e)))}t.forEach((e=>{i.includes(e.campaign.id)&&e.execute()}))}))}}class Mt{constructor(e,t,i){this.tracker=e,this.storage=t,this.config=i}logAbTest(t,i){return this.storage.get("abTests").then((n=>{n||(n={[t.id]:{index:0,isLogged:!1}}),(0,e.Z)("ab").info(`AB test for campaign ${t.id}: variation ${t.groupId} win`);return n[t.id]&&n[t.id].isLogged?Promise.resolve():this.storage.update("abTests",(e=>{const n=e||{};n[t.id]=n[t.id]||{},n[t.id].isLogged=!0;return new Le(this.tracker,t,i).track("test-passed",!0),n}))}))}}const $t=(0,e.Z)("precheckout-watcher"),Wt=(0,e.Z)("performance");function qt(e,i,n,r,s,o,a,c,u,l,d,h,p,m,g){const f=new Mt(u,e,{});let w=[],v=0;const y=new Ft(e,n,r,a,d,o);function b(e,t){Promise.all(e).then((e=>{t===v&&(e.forEach((e=>{e.isBackgroundExecute?k(e).execute():y.push(k(e))})),g.set(e),w=[...w,...e])}))}function _(e){v++;const t=v,i=(w||[]).map((e=>e.id)),n=e.filter((e=>!i.includes(e.id))),r=e.map((e=>e.id));w=w.reduce(((e,t)=>(r.includes(t.id)?e.push(t):y.removeTriggerByCampaignId(t.id),e)),[]),b(n,t)}function k(e){let i;return null==e.widget?i=e.noShowLabel?()=>function(e){const t=new Le(u,e,d.getTrackingSettings(),s);t.track("no-show",!0)}(e):()=>function(e){const t=new Le(u,e,d.getTrackingSettings(),s);t.track("error",!0)}(e):"true"===e.widget.meta["light-widget"]?i=function(e){const i={cid:e.id,vid:e.widget.versionId,motivationId:e.widget.meta.motivation_id};return function(n){var r;if("60072"===e.id&&104===function(){function e(e,t){for(let i=0,n=e.length;i<n;i++)if(t(e[i]))return e[i];return null}const i=e(Array.prototype.slice.call(document.querySelectorAll("script[src]")).map((e=>e.getAttribute("src")||"")),t.F5);if(i){const e=i.match("site_id=([0-9]+)");if(e&&e[1])return parseInt(e[1],10)}return null}()){new Le(u,e,d.getTrackingSettings(),s).track("before-show-widget",!0)}function o(r){if(n.state.expired)return;const{isGaTrackPerSession:o}=e,a="true"===e.widget.meta.closeOutside,{optinVersionId:c}=e.widget.meta,l=e.widget.meta.closeOutsideSeconds,h=function(e){let i=null;if(e.meta.containerSelector){const[n,r]=(0,t.wZ)(e.meta.containerSelector);if(i=document.querySelector(r),i&&("before"===n||"after"===n)){const e=document.createElement("span");if(e.classList.add("fl-embedded-wrapper"),null!=i.parentNode){const t="before"===n?i:i.nextSibling;i.parentNode.insertBefore(e,t)}i=e}if(i&&e.meta.containerWrapper){const t=document.createElement("div");t.innerHTML=e.meta.containerWrapper;t.firstElementChild.classList.add("fl-custom-wrapper");const n=t.firstChild;null!=n&&i.insertBefore(n,i.firstChild),i=n}return i}return document.body}(e.widget);if(null!=h){const t=new Le(u,e,d.getTrackingSettings(),s),p=Number(l);m.create(r,{closeOutside:a,closeOutsideSeconds:p,gaTracker:t,isGaTrackPerSession:o,root:h,optinVersionId:c,motivationId:i.motivationId,trigger:n})}}if(null===(r=null==e?void 0:e.widget)||void 0===r?void 0:r.content){const t={cid:i.cid,html:e.widget.content,vid:i.vid};try{o(t)}catch(e){$t.error(e,{label:"Create light widget err. (setup-api)",cid:i.cid})}}else p.widget(i).then(o).catch((e=>{$t.error(e,{label:"Create light widget err. (get-widget)",cid:i.cid})}))}}(e):$t.warn("Bridge widgets are not supported anymore"),new c.Trigger({campaign:e,variables:d.getVariables(),conditions:zt(e),callback:t=>{i(t),e.abTestEnabled&&f.logAbTest(e,d.getTrackingSettings())}})}return Wt.info("triggerManager start",performance.now()),{update:(e,t=!1)=>d.update(e).then((()=>{t?function(e){v++;const t=v;y.removeAllTriggers(),w=[],b(e,t)}(d.getCampaigns()):_(d.getCampaigns())})),reset(){g.set(d.getCampaigns()),_(d.getCampaigns())}}}function zt(e){return function(e){if(null==e)return!0;const i=(0,t.X)(e);return 0===i.length||1===i.length&&"$or"===i[0][0]&&null==i[0][1]}(e.triggers)?{url:{$match:""}}:e.triggers}const Bt=Number(new Date)/1e3-2678400,Ht=Number(new Date)-26784e5,Kt=e=>function(t){let i;const n=t.slice().reverse();for(i=0;i<n.length;i++){const t=n[i];if(e(t,i))break}return n.slice(0,i).reverse()},Gt={reducePageViewsLog:Kt(((e,t)=>t>30||e.timeIntervals[e.timeIntervals.length-1].end<Bt)),reducePrecheckoutShownLog:Kt(((e,t)=>t>50||e.date<Ht)),reduceSessionDaysLog:e=>e.slice(-30),reduceItemsViewLog(e,t){let i=(r=e=>e.length,(null!=(n=e)?r(n):void 0)?e.slice():[]);var n,r;const s=i.length&&i[i.length-1].sessionId;if(t&&s){let e=-1;for(let n=0;n<i.length;n++){if(i[n].sessionId===t){e=n;break}}e>0&&(i=i.slice(e-1))}else i=s?[]:i.slice(-1);return i}};const Zt=18e5,Jt=18e5,{reduceItemsViewLog:Qt}=Gt,Yt=e=>null==e.count?"quantity":"count",Xt=e=>{const t=Object.assign({},e),i=Yt(e);null!=e.id&&(t.id=String(e.id));const n=parseFloat(e[i]);Number.isNaN(n)||(t[i]=n);const r=parseFloat(e.price);return Number.isNaN(r)||(t.price=r),t},ei=e=>{let t=e.item||e.products||{};return Array.isArray(t)||(t=[t]),t.map(Xt)};function ti(e,i,{siteId:n},r){class s{constructor(){this.updated=!1,this.items=[],e.get("cart").then((e=>{e&&e.items&&!this.updated&&e.expireAt>Date.now()&&(this.items=e.items)}))}save(){return e.set("cart",{items:this.items,expireAt:Date.now()+Zt})}addItem(e){const n=(0,t.RH)({},e),r=this.items.find((e=>e.id===n.id));if(r){r[Yt(r)]+=n[Yt(n)]}else this.items.push(n);i.trackAddToCart(n)}addItems(e){const i=(0,t.RH)({},e);ei(i).forEach((e=>this.addItem(e))),this.save()}removeItem(e){const t=this.items.find((t=>t.id===e.id));if(t){const n=Yt(t);t[n]-=e[Yt(e)],t[n]=Math.max(t[n],0),i.trackRemoveFromCart(e),e=Object.assign(Object.assign({},t),e)}}removeItems(e){ei((0,t.RH)({},e)).forEach((e=>this.removeItem(e))),this.items=this.items.filter((e=>e[Yt(e)]>0)),this.save()}reset(){this.items=[],this.save()}getItemsCount(){return this.items.reduce(((e,t)=>e+Math.max(t[Yt(t)],0)),0)}getTotalPrice(){return this.items.reduce(((e,t)=>e+t.price*Math.max(t[Yt(t)],0)),0)}getFieldFromCardItems(e){return this.items.map((t=>t[e]))}update(e){var t;const n=(null===(t=null==e?void 0:e.cart)||void 0===t?void 0:t.items)||[];this.updated=!0;const r=this.items;this.items=n.map(Xt),this.save(),this.items.forEach((e=>{const t=r.find((t=>t.id===e.id));if(t){const n=Yt(t),r=parseFloat(e[n])-parseFloat(t[n]);r>0?i.trackAddToCart({id:e.id,quantity:r}):r<0&&i.trackRemoveFromCart({id:e.id,quantity:-r})}else i.trackAddToCart(e)}));r.filter((e=>!this.items.find((t=>t.id===e.id)))).forEach((e=>i.trackRemoveFromCart(e)))}}class o{constructor(){this.updated=!1,this.items=[]}addItem(e){const n=(0,t.RH)({},e);this.items.find((e=>e.id===n.id))||this.items.push(n),i.trackAddToFavorites(n)}addItems(e){const i=(0,t.RH)({},e);ei(i).forEach((e=>this.addItem(e)))}removeItem(e){const t=this.items.findIndex((t=>t.id===e.id));t>=0&&this.items.splice(t,1),i.trackRemoveFromFavorites(e)}removeItems(e){ei((0,t.RH)({},e)).forEach((e=>this.removeItem(e)))}reset(){this.items=[]}update(e){var t;const n=(null===(t=null==e?void 0:e.favorites)||void 0===t?void 0:t.items)||[];this.updated=!0;const r=this.items;this.items=n.map(Xt);const s=(e,t)=>e.id===t.id,o=(e,t,i)=>e.filter((e=>!t.some((t=>i(e,t))))),a=o(r,this.items,s);o(this.items,r,s).forEach((e=>i.trackAddToFavorites(e))),a.forEach((e=>i.trackRemoveFromFavorites(e)))}}class a{constructor(){this.update=this.update.bind(this),this.isAuthorized=this.isAuthorized.bind(this),this.save=this.save.bind(this),this.location={},this.name=null,this.email=null,this.stats={}}isUserChanged(e){return this.email!==e.email}logout(){this.email=null,this.name=null}update(e){e.name&&(this.name=e.name),e.email&&(this.email=e.email),null!=e.location&&(this.location=e.location)}isAuthorized(){return/\S+@\S+\.\S+/.test(this.email)}hasName(){return!!this.name}save(){}}class c{constructor(){this.sync=this.sync.bind(this),this.mergeAndAssignTags=this.mergeAndAssignTags.bind(this),this.getReferrerToTags=this.getReferrerToTags.bind(this),this.tags={},this.hypotheticalTags={}}sync(i){const n=Ct(String.prototype.slice.call(document.cookie));return e.get(Ye.utmTags).then((r=>(this.mergeAndAssignTags(n,(0,t.mx)(),r||{},this.getReferrerToTags(document.referrer)),e.set(Ye.utmTagsHypothetical,this.hypotheticalTags),e.set(Ye.utmTags,this.tags).then((()=>i())).catch((()=>i())))))}mergeAndAssignTags(e,t,i,n){const r={source:"utmcsr",medium:"utmcmd",campaign:"utmccn",term:"utmctr",content:"utmcct"},s=parseInt(t.utm_nooverride,10);["campaign","source","medium","term","content"].forEach((o=>{const a=e.utmz[r[o]],c=t[`utm_${o}`]||n[o];let u=a;s||(u=u||c),u=u||i[o],u&&(this.tags[o]=u),c&&!s&&(this.hypotheticalTags[o]=c)}))}getReferrerToTags(e){const t={source:null,medium:null,campaign:null};if(!e)return t;const i=e.split("/")[2],n=e=>e.split(".").slice(-2).join(".");return/google\.(com|ru)/i.test(e)?(t.source="google",t.medium="organic"):/googleadservices\.com/i.test(e)?(t.source="google",t.medium="cpc"):/yandex.ru\/clck/i.test(e)?(t.source="yandex",t.medium="organic"):n(i)!==n(window.location.host)&&(t.source=i,t.medium="referral",t.campaign="referral"),t}}class u{constructor(){e.get(Ye.categoryViewLog).then((e=>{this.log=e?e.ids:{}})),this.currentCategory=void 0}getCurrent(){return this.currentCategory}getCountViews(){return Object.keys(this.log).length}reset(){this.currentCategory=void 0}add(e){this.currentCategory=e,this.log[e]=this.log[e]+1||1,this.save()}save(){e.set(Ye.categoryViewLog,{ids:this.log,expireAt:Date.now()+Jt})}}class l{constructor(){e.get(Ye.pushSubscribeLog).then((e=>{this.log=e||{}}))}saveLastSubscriptionTimestamp(){return e.set(Ye.pushSubscribeLog,{lastSubscriptionTimestamp:+Date.now()},{expireAt:+new Date+15552e6})}getLastSubscriptionTimestamp(){return e.get(Ye.pushSubscribeLog).then((e=>e?e.lastSubscriptionTimestamp:null))}}class d extends Ue.EventEmitter{constructor(){super(),this.sync=this.sync.bind(this),this.addData=this.addData.bind(this),this.addMeta=this.addMeta.bind(this),this.getData=this.getData.bind(this),this.getUser=this.getUser.bind(this),this.getCart=this.getCart.bind(this),this.getHypotheticalUtmTags=this.getHypotheticalUtmTags.bind(this),this.addItemView=this.addItemView.bind(this),this.getCurrentItem=this.getCurrentItem.bind(this),this.resetItem=this.resetItem.bind(this),this.resetCategory=this.resetCategory.bind(this),this.getItemsViews=this.getItemsViews.bind(this),this.user=new a,this.cart=new s,this.favorites=new o,this.assigns={},this.utmTags=new c,this.category=new u,this.push=new l,this.meta={}}sync(e){this.utmTags.sync(e)}addData(e){const i=e.user||e.customer;i&&this.user.isUserChanged(i)&&(""===i.email?this.user.logout():this.user.update(i),this.emit("add-user",i)),e.cart&&(this.cart.update(e),this.emit("add-cart",e.cart)),e.favorites&&(this.favorites.update(e),this.emit("add-favorites",e.favorites)),e.assigns&&((0,t.RH)(this.assigns,e.assigns),this.emit("add-assigns",e.assigns)),e.category&&this.category.add(String(e.category.id)),e.meta&&this.addMeta(e.meta)}addMeta(e){this.meta=Object.assign(this.meta,e),this.setSnapshotMeta(e)}getData(){return{user:this.user,cart:this.cart,favorites:this.favorites,site:{id:n},assigns:this.assigns,category:this.category,meta:(0,t.RH)({},this.meta),getSessionId:()=>r.getGlobalSessionId()}}getUser(){return this.user}getCart(){return this.cart}getUtmTags(){return this.utmTags.tags}getHypotheticalUtmTags(){return this.utmTags.hypotheticalTags}addItemView(t){const i=t&&t.item&&t.item.id;return i?(this.currentItemId=i,this.emit("add-item-view",i),e.get(Ye.itemsViewLog).then((t=>{const n=r.getSessionId();return(t=Qt(t,n)).push({itemId:i,sessionId:n}),e.set(Ye.itemsViewLog,t)}))):Promise.reject()}resetItem(){this.currentItemId=void 0}resetCategory(){this.category.reset()}getCurrentItem(){return new Promise((e=>this.currentItemId?e(this.currentItemId):this.on("add-item-view",(function(){return e(this.currentItemId)}))))}getItemsViews(){return e.get(Ye.itemsViewLog).then((e=>{if(!e)return[];const t=e.map((e=>e.itemId)),i={};return t.forEach((e=>{i[e]=1})),Object.keys(i)}))}isProductPage(){return!!this.currentItemId}isCategoryPage(){return!!this.category.getCurrent()}getSnapshotMeta(){return this.getSnapshotMetaRaw().then((e=>(e||{}).snapshot||{}))}getSnapshotMetaRaw(){return e.get(Ye.snapshotMeta)}setSnapshotMeta(t){return this.getSnapshotMetaRaw().then((i=>{(i=i||{}).snapshot=i.snapshot||{},(!i.clearAt||i.clearAt<Date.now())&&(i.clearAt=Date.now()+12096e5,i.snapshot={}),Object.assign(i.snapshot,t||{}),e.set(Ye.snapshotMeta,i)}))}compareSnapshotMeta(e){return this.getSnapshotMeta().then((t=>{e=e||{},t=t||{};try{if(JSON.stringify(e)===JSON.stringify(t))return!0}catch(e){}const i=Object.keys(e)||[],n=Object.keys(t)||[],r=i.filter((i=>Object.prototype.hasOwnProperty.call(t,i)&&e[i]===t[i]));return r.length===i.length&&r.length===n.length}))}compareSnapshotMetaByPart(e){return this.getSnapshotMeta().then((t=>{const i=Object.assign(Object.assign({},t),e||{});return this.compareSnapshotMeta(i)}))}}const h=new d;return new Promise((e=>h.sync((()=>e(h)))))}const{reducePageViewsLog:ii}=Gt,ni=Ye.pageViewsLog,ri=Ye.categoryViewLog,si=Ye.itemsViewLog,oi=()=>Math.round(Number(new Date)/1e3),ai=e=>e.reduce(((e,t)=>e+t.timeIntervals.reduce(((e,t)=>e+(t.end-t.start)),0)),0);function ci(e,i){return{cleanLog:li,track(){const n=Math.round(Je.checkInterval/1e3);return e.get(ni).then((r=>{let s=[];null!=r&&(s=r),s=li(s,i.getSessionId());let o=(0,t.dF)(s,(e=>e.viewId===i.getViewId()));const a=oi();if(o){const e=(0,t.dF)(o.timeIntervals,(e=>a-e.end<=n));e?e.end=a:o.timeIntervals.push({start:a,end:a})}else o={viewId:i.getViewId(),sessionId:i.getSessionId(),pageUrl:window.location.href,timeIntervals:[{start:a,end:a}]},s.push(o);return s=ii(s),e.set(ni,s)}))},getSessionViewsCount:t=>e.get(ni).then((e=>{e||(e=[]);const n=e.reduce(((e,t)=>e+(t.sessionId===i.getSessionId()?1:0)),0);return t(n)})),getSessionPageUrls:n=>e.get(ni).then((e=>n(((e,i=[])=>((0,t.hu)(e,"no ssid"),null===i?[]:i.filter((t=>t.sessionId===e)).map((e=>e.pageUrl))))(i.getSessionId(),e)))),getSessionActivityDuration:t=>e.get(ni).then((e=>{const n=(e||[]).filter((e=>e.sessionId===i.getSessionId()));return t(ai(n))})),getPageActivityDuration:t=>e.get(ni).then((e=>{const n=(e||[]).filter((e=>e.viewId===i.getViewId()));return t(ai(n))})),getCategoriesViews:t=>e.get(ri).then((e=>t(Date.now()<=e.expireAt?e:{}))),getCardsViews:t=>e.get(si).then((e=>{const n=(e||[]).filter((e=>e.sessionId===i.getSessionId()));return t(n)})),sessionIsFirst:n=>e.get(ni).then((e=>(e||(e=[]),n(!(0,t.dF)(e,(e=>e.sessionId!==i.getSessionId())))))),sessionStartUrl:t=>e.get(ni).then((e=>{let i;e||(e=[]);const n=ui(e[e.length-1],(e=>e.sessionId));null!=n&&(i=e.reduce(((e,t)=>(t.sessionId===n&&(!e.time||e.time>t.timeIntervals[0].start)&&(e.time=t.timeIntervals[0].start,e.url=t.pageUrl),e)),{}));const r=ui(i,(e=>e.url))||window.location.href;return t(r)})),getShownCampaignsInSession:n=>e.get(Ye.precheckoutShownLog).then((e=>{const r=(e||[]).filter((e=>e.session===i.getSessionId())).map((e=>String(e.campaign)));return n((0,t.jj)(r))})),getUserSubscriptionStatus(t){const n=i.getSessionId();return e.get(Ye.isUserSubscribed).then((i=>(null==i?void 0:i.sessionId)&&i.sessionId!==n?(e.set(Ye.isUserSubscribed,{}),t(!1)):t(Boolean(null==i?void 0:i.isSubscribed))))}}}function ui(e,t){return null!=e?t(e):void 0}function li(e,t){if(!e.length)return e;let i=e.slice(0);i.sort(((e,t)=>e.timeIntervals[0].start-t.timeIntervals[0].start));const n=i[0].sessionId;return i=i.filter((e=>e.sessionId===n||e.sessionId===t)),i}class di{constructor(e,t){this.storage=e,this.sessionId=t.getSessionId()}_initNewSessionData(){return{sessionId:this.sessionId,campaignIdsToActionsMap:{}}}_cleanOldSessionData(e){return e.sessionId!==this.sessionId?this._initNewSessionData():e}_getEaEvents(){return this.storage.get(di.STORAGE_KEY)}_setEaEvents(e){return this.storage.set(di.STORAGE_KEY,e)}handleEvent(e,t){const i=di.buildDataKey(e,t);return this._getEaEvents().then((e=>{const n=e?this._cleanOldSessionData(e):this._initNewSessionData();let r=n.campaignIdsToActionsMap[i];return r||(r=[],n.campaignIdsToActionsMap[i]=r),-1===r.indexOf(t)&&r.push(t),this._setEaEvents(n)}))}isFirstEvent(e,t){const i=di.buildDataKey(e,t);return this._getEaEvents().then((e=>{if(!e)return!0;const n=this._cleanOldSessionData(e).campaignIdsToActionsMap[i];return!(n&&n.length>0)||!n.includes(t)}))}}di.STORAGE_KEY=Ye.campaignEaEvents,di.factory=(e,t)=>new di(e,t),di.buildDataKey=(e,t)=>{const{id:i,noShowCategory:n,trackCategory:r}=e;let s="no-show"===t?n:r;return s||(s="DEFAULT_CATEGORY_KEY"),`${i}-${s}`};const hi=di;class pi extends Ue.EventEmitter{constructor(){super(),this.storage={},this.isExpired=!1}determineExpirationAndFireEventIfNecessary(){const e=this.isExpired,{timestamp:t}=this.storage;return this.isExpired=t&&Date.now()-t>=216e5,this.isExpired&&!e&&this.emit(pi.EVENTS.EXPIRED),this.isExpired}getSetupApiData(){return this.storage.setupApiData||{}}setSetupApiData(e){this.isExpired=!1,this.storage={timestamp:Date.now(),setupApiData:e}}}pi.EVENTS={EXPIRED:"expired"},pi.factory=()=>new pi;const mi=pi,gi=(0,e.Z)("performance");function fi(e,i,n,r,s,o,a){const c=a&&a.checkInterval||1e3,u=a&&a.checkWithoutFocus||!1;return new class{constructor(e,t,i,n,r){this.startWatching=this.startWatching.bind(this),this.initialEventWatch=this.initialEventWatch.bind(this),this.checkConditions=this.checkConditions.bind(this),this.trackPageViews=this.trackPageViews.bind(this),this.getInactivityDuration=this.getInactivityDuration.bind(this),this.storage=e,this.behaviorStorage=t,this.documentWatcher=i,this.customEvents=n,this.shareData=r,this.lastActivity=new Date,this.viewsLog=null,this.events=new Ue.EventEmitter,this.events.setMaxListeners(0),this.initialEventWatch(),this.startWatching(),gi.info("behaviorWatcher init",performance.now())}startWatching(){const e=(0,t.P2)((()=>{this.lastActivity=new Date}),1e3);document.addEventListener("click",e),document.addEventListener("keypress",e),document.addEventListener("keydown",e),document.addEventListener("contextmenu",e);const i={customEvents:this.initialEvents.events.slice(),events:[]};let n=(0,t.RH)({},i);this.check=(0,t.P2)((()=>{if(this.documentWatcher.hasFocus()||u){const e=(0,t.RH)({},n);this.trackPageViews((()=>this.events.emit("check",e))),n=(0,t.RH)({},i)}}),c/2,{leading:!0}),this.documentWatcher.events.on("locationchange",(()=>{this.events.emit("locationchange"),this.check()})),this.documentWatcher.events.on("focus",(()=>{n.events.push("document_focus"),this.check()})),this.documentWatcher.events.on("blur",(()=>{n.events.push("document_blur"),this.check()})),this.documentWatcher.events.on("leave",(e=>{this.shareData.addMeta({exitCoordinates:e}),n.events.push("document_leave"),this.check()})),this.events.on("end_check_triggers",(()=>{n.events=[]})),this.initialEvents.off(),this.customEvents.on("fireEvent",(e=>{n.customEvents.push(e.event),this.check()})),this.customEvents.on("clean",(()=>{n.customEvents=[]})),this.customEvents.on("loaderReady",(()=>{this.check()})),setInterval(this.check,c)}initialEventWatch(){const e=[],t=t=>e.push(t.event);this.customEvents.on("fireEvent",t),this.initialEvents={events:e,off:()=>this.customEvents.removeListener("fireEvent",t)}}checkConditions(){this.check()}trackPageViews(e){this.behaviorStorage.track().then((()=>e())).catch((()=>e()))}getInactivityDuration(){return Number(new Date)-Number(this.lastActivity)}}(e,i,n,r,s)}class wi{constructor(e){this._testing=!1,this._stopWatchFocus=()=>null,null!=e&&e.testing&&(this._testing=!0),this.events=new Ue.EventEmitter,this.events.setMaxListeners(0),function(e){let t=!1;const i=()=>{t||(t=!0,document.removeEventListener("DOMContentLoaded",i,!1),window.removeEventListener("load",i,!1),e())};"complete"===document.readyState||"interactive"===document.readyState?i():(document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1))}((()=>(this._watchFocus(),this._watchLeaving(),this._watchLocation())))}destroy(){this._stopWatchFocus()}_watchFocus(){let e;this._pageFocused=this._isPageFocused();const i=(0,t.P2)((t=>{e=this._isPageFocused(t),e!==this._pageFocused&&(this._pageFocused=e,this._emitFocusChange())}),500),n=()=>i();document.addEventListener("visibilitychange",n);const r=()=>i({focused:!0});window.addEventListener("focus",r);const s=()=>i({focused:!1});let o;window.addEventListener("blur",s),this._hasDocFocus()&&(o=setInterval(i,500));const a=(0,t.Ds)((()=>i({focused:!0})||!0),100);window.addEventListener("mousemove",a),window.addEventListener("scroll",a),this._stopWatchFocus=()=>{document.removeEventListener("visibilitychange",n),window.removeEventListener("focus",r),window.removeEventListener("blur",s),window.removeEventListener("mousemove",a),window.removeEventListener("scroll",a),o&&clearInterval(o)}}_isPageFocused(e={}){let t=null!=e.focused?e.focused:!this._hasDocFocus()||document.hasFocus();return this._hasDocVisibility()&&(t=t&&!document.hidden),t}_hasDocFocus(){return null!=document.hasFocus&&!this._isTestEnv()}_hasDocVisibility(){return!document.hidden&&!this._isTestEnv()}_isTestEnv(){return this._testing}_emitFocusChange(){return this._pageFocused?this.events.emit("focus"):this.events.emit("blur")}_watchLeaving(){return setTimeout((()=>{let e;try{e=window.top.document}catch(t){e=window.document}const{body:t}=e;return t.addEventListener("mouseout",(e=>{let t;if("SELECT"!==e.target.tagName){try{t=e.clientY<Qe}catch(e){}t&&this.events.emit("leave",{x:e.clientX,y:e.clientY})}}))}),1e3)}_watchLocation(){window.addEventListener("popstate",(e=>{e.state&&this.events.emit("locationchange")}))}hasFocus(){return this._pageFocused}getBattery(e){return null!=window.navigator&&null!=window.navigator.getBattery?window.navigator.getBattery().then((t=>e(t.level))).catch((()=>e(1))):e(1)}}function vi(e){return new wi(e)}class yi extends Ue.EventEmitter{constructor(e){super(),this.tracker=e}fireEvent(e){return e.noTrack||this.tracker.trackCustomEvent(e.event),this.emit("fireEvent",e)}}function bi(e){return new yi(e)}const _i=(e=>/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4)))(navigator.userAgent||navigator.vendor),ki=(0,e.Z)("triggers"),Si=function(e){if("object"!=typeof e)return e;let t=e.$value;const i=e.$unit;if("days"===i&&(t*=86400),"hours"===i&&(t*=3600),"minutes"===i&&(t*=60),"time"===i){const[e,i]=t.split(":").map((e=>parseInt(e,10)));t=(new Date).setHours(e,i)}return t};function Ei(i,n,r,s,o,a){(0,t.hu)(i&&n&&r&&s&&o,"Trigger Factory args");let c=window.document.referrer||"";try{c=decodeURI(c)}catch(e){}const u=function(e){let t;return t=e.$and?new h(e.$and):e.$or?new p(e.$or):e.$not?new m(e.$not):new g(e),t},l=(i,n)=>{if(null==i&&!(e=>{if(!e||"object"==typeof e&&0===Object.keys(e).length)return!1;const t=Object.keys(e);return 1===t.length&&["$isNull","$notNull"].includes(t[0])})(n))return!1;if(!n||"object"==typeof n&&0===Object.keys(n).length)return!0;let r=!0;if("object"!=typeof n)r=i===n;else{if(null==n.$eq&&"boolean"!=typeof n.$eq||(r=r&&i===Si(n.$eq)),r&&null!=n.$match&&(r=-1!==i.toLowerCase().trim().indexOf(String(Si(n.$match).trim()).toLowerCase())),r&&null!=n.$regex)try{const e=(0,t.QC)(n.$regex,o.getVariables());r=new RegExp(e,"i").test(i)}catch(t){(0,e.Z)("triggers").warn("Regex condition failed",n.$regex),r=!1}if(r&&null!=n.$eval)try{r=new Function(n.$eval)({cart:s.cart})}catch(t){r=!1,(0,e.Z)("triggers").warn("Custom JS trigger have failed",n.$eval)}if(r&&n.$ne&&(r="object"!=typeof n.$ne||n.$ne.$unit?i!==Si(n.$ne):!l(i,n.$ne)),r&&n.$gte&&(r=i>=Si(n.$gte)),r&&n.$gt&&(r=i>Si(n.$gt)),r&&n.$lte&&(r=i<=Si(n.$lte)),r&&n.$lt&&(r=i<Si(n.$lt)),r&&n.$or&&(r=n.$or.some((e=>l(i,e)))),r&&n.$includes){const e=Array.isArray(i)?i:[i];r=n.$includes.some((t=>e.includes(t)))}if(r&&n.$nincludes){const e=Array.isArray(i)?i:[i];r=n.$nincludes.every((t=>!e.includes(t)))}if(r&&n.$has&&(r=!0===i[n.$has[0]]),r&&n.$hasNot&&(r=!1===i[n.$hasNot[0]]),r&&n.$and&&(r=n.$and.every((e=>l(i,e)))),r&&n.$between){const e=Si(n.$between[0]),t=Si(n.$between[1]);r=t>e&&i>=e&&i<=t||t<e&&(i>=e||i<=t)}r&&n.$value&&(r=i===Si(n)),r&&"boolean"==typeof n.$isNull&&(r=!i===Si(n.$isNull)),r&&"boolean"==typeof n.$notNull&&(r=!!i===Si(n.$notNull))}return r};class d{constructor(e){Array.isArray(e)?this.expressions=e.map((e=>u(e))):this.expressions=Object.keys(e).map((t=>u(e[t])))}getContext(){return this.context}setContext(e){this.context=e,this.expressions.forEach((t=>t.setContext(e)))}}class h extends d{check(){return Promise.all(this.expressions.map((e=>e.check())))}}class p extends d{check(){let e=this.expressions.length;return new Promise(((t,i)=>{this.expressions.forEach((n=>{n.check().then((()=>t())).catch((()=>{e--,e<=0&&i()}))}))}))}}class m extends d{constructor(e){super(e),this.expression=u(e)}setContext(e){return this.context=e,this.expression.setContext(e)}check(){return new Promise(((e,t)=>{this.expression.check().then(t).catch(e)}))}}class g{constructor(e){this.check=this.check.bind(this),this.expr=e}setContext(e){this.context=e}getContext(){return this.context}isBrowserSupportsPush(){return(0,t.fr)()?"safari"in window&&"pushNotification"in window.safari:"Notification"in window&&"serviceWorker"in navigator}check(){const[u,d]=(0,t.X)(this.expr)[0];return new Promise(((h,p)=>{const m=e=>{e?(ki.info(`Trigger ${u} for campaign ${this.getContext().campaign.id} passed. Value: `,d),h()):setTimeout(p,1)},g=o.getUtmTags();switch(u){case"event":return m(this.context.events.some((e=>l(e,d))));case"custom_event":return m(this.context.customEvents.some((e=>l(e,d))));case"custom_js":return m(l(!0,d));case"html_element":const h=Object.keys(d)[0],p=(0,t.QC)(d[h],o.getVariables()),f=(0,t.kz)(p),w=(0,t.am)(f);return m(l(w,{[h]:!0}));case"custom_js_value":case"datalayer":const v=(e=>{const{$eval:i}=e;if(!i)return null;const{$value:n}=i;return[(0,t.QC)(n,o.getVariables()),(0,t.$W)(i)]})(d),y=v[0];return m(l((t=>{let i;try{i=new Function(t)({cart:s.cart})}catch(i){(0,e.Z)("triggers").warn("Custom JS Value trigger have failed",t)}return i})(y),(0,t.$W)(v[1])));case"views_count":return i.getSessionViewsCount((e=>m(l(e,d))));case"items_views_count":return s.getItemsViews().then((e=>m(l(e.length,d))));case"session_activity_duration":return i.getSessionActivityDuration((e=>m(l(e,d))));case"page_activity_duration":return i.getPageActivityDuration((e=>m(l(e,d))));case"inactivity_duration":return m(l(n.getInactivityDuration()/1e3,d));case"session_is_first":return i.sessionIsFirst((e=>m(l(e,d))));case"url":return m(l(window.location.href,d));case"url_in_history":return i.getSessionPageUrls((e=>{m(e.some((e=>l(e,d))))}));case"url_in_history_times":{const e=parseInt((d.$eq||d.$regex).$count,10);return i.getSessionPageUrls((t=>{m(t.filter((e=>{const{origin:t,pathname:i}=new URL(e),n=`${t}${i.replace(/\/$/,"")}`,r=`${t}${i}`;return l(e,d)||l(n,d)||l(r,d)})).length>=e)}))}case"session_start_url":return i.sessionStartUrl((e=>m(l(e,d))));case"referrer":return m(l(c,d));case"is_mobile":return m(l(_i,d));case"cookie":const b=V.Z.get();let _=Object.keys(b).map((e=>{const t=b[e];return t&&"0"!==t&&"false"!==t?e:null}));return _=_.filter((e=>e)),m(_.some((e=>l(e,d))));case"is_shown_in_session":return i.getShownCampaignsInSession((e=>{const t=e.includes(String(this.context.campaign.id));m(l(t,d))}));case"is_campaign_shown_in_session":return i.getShownCampaignsInSession((e=>{m(l(e,d))}));case"user_is_authorized":return m(l(this.context.user.isAuthorized(),d));case"user_has_name":return m(l(this.context.user.hasName(),d));case"category_viewed_times":{const{$eq:{id:e,count:t}}=d;return i.getCategoriesViews((i=>{m((i.ids||[])[e]>=t)}))}case"card_viewed_times":return i.getCardsViews((e=>{const t=e.reduce(((e,{itemId:t})=>(e[t]=(e[t]||0)+1,e)),{});m(Object.values(t).some((e=>l(e,d))))}));case"cart_items_count":return m(l(this.context.cart.getItemsCount(),d));case"cart_total_price":return m(l(this.context.cart.getTotalPrice(),d));case"cart_add_item":const k=this.context.customEvents.some((e=>"flock_api_add_to_cart"===e));return m(l(k,d));case"cart_items_has_category":return m(this.context.cart.getFieldFromCardItems("categoryId").some((e=>l(e,d))));case"cart_items_has_brand":return m(this.context.cart.getFieldFromCardItems("brand").some((e=>l(e,d))));case"utm_source":return m(l(g.source,d));case"utm_campaign":return m(l(g.campaign,d));case"utm_medium":return m(l(g.medium,d));case"utm_content":return m(l(g.content,d));case"gclid":return i.getSessionPageUrls((e=>{m(e.some((e=>{const i=(0,t.ak)("gclid",e);return l(i,d)})))}));case"category":return m(l(s.category.getCurrent(),d));case"battery":return r.getBattery((e=>m(l(100*e,d))));case"notification_status":return m(l(String("Notification"in window&&Notification.permission),d));case"is_browser_supports_push":return m(l(this.isBrowserSupportsPush(),d));case"local_time":return m(l(new Date,d));case"spot":const S=[].slice.call(window.document.querySelectorAll("[data-fl-spot]")).map((e=>e.getAttribute("data-fl-spot")));return m(S.some((e=>l(e,d))));case"scroll":const E=document.documentElement,{body:I}=document,A=(E.scrollTop||I.scrollTop)/((E.scrollHeight||I.scrollHeight)-E.clientHeight)*100;return m(l(A,d));case"is_product_page":return m(l(s.isProductPage(),d));case"is_category_page":return m(l(s.isCategoryPage(),d));case"count_category_views":return m(l(s.category.getCountViews(),d));case a.getKey():if(!s.currentItemId)return m();const T=a.checkSku(s.currentItemId);return null===T?m():m(l(T,d));case"is_user_subscribed":return i.getUserSubscriptionStatus((e=>m(l(e,d))));case"is_incognito":return m(!0);default:return ki.warn(`wrong trigger condition ${u}`,d),m()}}))}}return{Trigger:class{constructor(e){this.campaign=e.campaign,this.conditions=e.conditions,this.callback=e.callback,this.variables=e.variables,this.rootExpression=u(this.conditions),this.state={executed:!1,expired:!1}}check(e){return this.state.executed||this.state.expired?null:(null==(e=Object.assign({},e)).user&&(e.user=s.getUser()),null==e.cart&&(e.cart=s.getCart()),null==e.campaign&&(e.campaign=this.campaign),null==e.event&&(e.event=[]),null==e.customEvents&&(e.customEvents=[]),this.rootExpression.setContext(e),new Promise((e=>{this.rootExpression.check().then((()=>{e([!0,this])})).catch((()=>{e([!1,this])}))})))}reset(){this.state.executed=!1}markExpired(){this.state.expired=!0}execute(){this.state.executed=!0,this.callback(this)}},__compare:l}}const Ii=(0,e.Z)("splitByExclusions"),Ai=e=>(e||[]).map((e=>+e)),Ti=e=>(e||[]).map((e=>String(e)));function Oi(e,i,n,r,s){const o=function(e,i,n,r,s){const o=e.map((e=>function(e,i,n,r,s){const o=Ai(e.campaigns),a=i.map((e=>1+o.indexOf(e))).filter((e=>e));let c=Math.min(...a);c=Number.isFinite(c)?c-1:0;let u=[];if(null!=e.timeConstraint&&0!==e.timeConstraint){const t=+new Date-1e3*e.timeConstraint*60*60*24,i=function(e){return e.reduce(((e,t)=>(e[t.campaign]=t.date,e)),{})}(s);Object.keys(i).forEach((e=>{i[e]>t&&o.includes(+e)&&u.push(+e)}))}else e.sessionConstraint?u=(0,t.jV)(r,o):e.pageConstraint&&(u=(0,t.jV)(n,o));return i.map((t=>{const i=function(e,t,i){const n=0===i.length,r=!e.campaigns.includes(String(t)),s=!!i.length&&t===i[0],o=e.sessionConstraint||e.timeConstraint?n||r||s:n||r;r||o||Ii.warn({cid:t,campainsFromConstraintWasShown:i.join(","),isAlreadyShown:s,exclusion:e});return o}(e,t,u),n=o.indexOf(t)-c;return i?{campaign:t,approve:!0,priority:n}:{campaign:t,approve:!1,priority:0}}))}(e,i,n,r,s))),a=function(e,t){const i=[];e.forEach((e=>{null!=e&&e.forEach((e=>{e.approve||i.push(e.campaign)}))}));const n=function(e){const t={};return e.forEach((e=>{let i=-1;e.forEach(((e,n)=>{i<0&&t[e]>0&&(i=n)})),i<0&&e.forEach(((e,n)=>{i<0&&-1!==t[e]&&(i=n)})),i>=0&&(t[e[i]]=1),e.forEach(((e,n)=>{n!==i&&(t[e]=-1)}))})),t}(function(e){return e.map((e=>{const t=[];return null!=e&&e.sort(((e,t)=>e.priority-t.priority)).forEach((e=>{e.approve&&e.priority>=0&&t.push(e.campaign)})),t}))}(e));return t.map((e=>{let t;t=i.includes(e)?-1:n[e]||1;return{approve:t>0,campaign:e,priority:0}}))}(function(e){const t=(e&&e[0]||[]).reduce(((t,{campaign:i},n)=>(t[i]=e.every((e=>e[n].approve)),t)),{});return e.map((e=>e.map((({campaign:e,priority:i})=>({campaign:e,approve:t[e],priority:i})))))}(o),i),[c,u]=(0,t.uK)(a,(e=>e.approve)),l=e=>e.campaign;return[c.map(l),u.map(l)]}(e,Ai(i),Ai(n),Ai(r),s);return[Ti(o[0]),Ti(o[1])]}const Ci=(0,e.Z)("approveCampaigns");function Pi(e){const{ids:i,closedIds:n,shownIds:r,inactivity:s,shownLog:o,sessionId:a,exclusions:c}=e;let[u,l]=(0,t.uK)(i,(e=>(e=>n.includes(e))(e)));u.forEach((e=>{Ci.info(`Campaign ${e} wants to show, but is closed.`)})),[l,u]=(0,t.uK)(l,(i=>{const n=s[String(i)];if(!n)return!0;const{count:r}=n,{period:o}=n;if(null==r||null==o||!(0,t.hj)(r)||!(0,t.hj)(o))return!0;const a=function(e,t,i){const n=(new Date).getTime()-t,r=i[String(e)]||{};return Object.keys(r).filter((e=>n<Number(e))).reduce(((e,t)=>e+r[t]),0)}(i,1e3*o,e.hitLog);return r>a})),u.forEach((e=>{Ci.info(`Campaign ${e} wants to show, but is in inactivity state.`)}));const d=function(e,i){const n=e.filter((e=>e.session===i)).map((e=>e.campaign));return(0,t.jj)(n)}(o,a);return[l,u]=Oi(c,l,r,d,o),u.forEach((e=>{Ci.info(`Campaign ${e} wants to show, but stopped by constraints.`)})),l}function Li(e,t,i,n){let r={source:"",medium:"",campaign:"",term:"",content:""};null!=i&&(r=i);const s={source:"utmcsr",medium:"utmcmd",campaign:"utmccn",term:"utmctr",content:"utmcct"},o=Ct(e),a=function(e){const t={source:"",medium:"",campaign:"",term:"",content:""};if(!e)return t;const i=e.split("/")[2],n=e=>e.split(".").slice(-2).join(".");/google\.(com|ru)/i.test(e)?(t.source="google",t.medium="organic"):/googleadservices\.com/i.test(e)?(t.source="google",t.medium="cpc"):/yandex.ru\/clck/i.test(e)?(t.source="yandex",t.medium="organic"):n(i)!==n(window.location.host)&&(t.source=i,t.medium="referral",t.campaign="referral");return t}(n),c=parseInt(t.utm_nooverride,10),u={source:"",medium:"",campaign:"",term:"",content:""},l={source:"",medium:"",campaign:"",term:"",content:""};return["campaign","source","medium","term","content"].forEach((e=>{const i=o.utmz[s[e]],n=t[`utm_${e}`]||a[e];let d=i;c||(d=d||n),d=d||r[e],d&&(u[e]=d),n&&!c&&(l[e]=n)})),[u,l]}const xi=(0,e.Z)("state"),Ni=18e5,{reducePrecheckoutShownLog:Di}=Gt,Ri="2";function Vi(e,i,n,r){const s=n.getInitialConfig();let o="/flock_push_worker.js";s.serviceWorkerPath&&(o=String(s.serviceWorkerPath));const a={workerPath:o,campaigns:s.campaigns,tracking:s.tracking,subdomain:s.subdomain,mutualExclusions:s.exclusions,shownIds:[],ip:s.clientIp,utmTags:{source:"",medium:"",campaign:"",term:"",content:""},utmTagsHypothetical:{source:"",medium:"",campaign:"",term:"",content:""},sessionId:"",viewId:Ge.v1(),precheckoutTest:s.precheckoutTest,vapidPublicKey:s.vapidPublicKey||null,enabledProducts:s["enabled-products"]||[],variables:s.variables||[],resubscribePushEnabled:s["push-subscription-version"]===Ri,externalTrackingDisabled:Boolean(s.externalTrackingDisabled)};function c(e){e?a.ip=e:xi.warn("Empty ip")}return Promise.all([e.get("utmTags"),Ui(e)]).then((([r,s])=>{a.sessionId=s;const o=Li(document.cookie,(0,t.mx)(),r,document.referrer);return a.utmTags=o[0],a.utmTagsHypothetical=o[1],e.set("utmTagsHypothetical",a.utmTagsHypothetical),e.set("utmTags",a.utmTags),{getSubdomain:()=>a.subdomain,getSessionId:()=>a.sessionId,getGlobalSessionId:()=>i&&i.isActionAvailable(ve.GET_GLOBAL_SESSION_ID)?i.getGlobalSessionId():Promise.resolve(null),getViewId:()=>a.viewId,updateViewId(){a.viewId=Ge.v1()},getWorkerPath:()=>a.workerPath,resetCampaignsShownIds(){a.shownIds=[]},dump:()=>JSON.parse(JSON.stringify(a)),setIp:c,getIp:()=>a.ip,getApprovedCampaigns:i=>0===i.length?Promise.resolve([]):Promise.all([e.get("precheckoutClosed"),e.get("campaignHitLog"),e.get("precheckoutShownLog")]).then((n=>{const r=Array.isArray(n[0])?n[0]:[],s=n[2]?function(e){if(!Array.isArray(e))return[];return e.map((e=>({date:new Date(e.date),campaign:e.campaign,session:e.session})))}(n[2]):[],o=Pi({ids:i,shownLog:s,shownIds:a.shownIds,exclusions:a.mutualExclusions,closedIds:r.map((e=>e.campaign)),inactivity:(c=a.campaigns,Object.fromEntries(c.map((e=>[e.id,e.inactivity])))),hitLog:n[1]||{},sessionId:a.sessionId});var c;return a.shownIds=(0,t.jj)(a.shownIds.concat(o)),function(e,i,n){const r="precheckoutShownLog",s=e.get(r).then((t=>{t=Array.isArray(t)?t:[];const s=+new Date;return i.forEach((e=>{t.push({date:s,campaign:e,session:n})})),t=Di(t),e.set(r,t)})),o="campaignHitLog",a=e.get(o).then((n=>{const r=n||{};return e.set(o,function(e,i){const n=(0,t.RH)({},e);return i.forEach((e=>{const t=function(e){const t=new Date(e);return t.setUTCHours(0),t.setUTCMinutes(0),t.setUTCSeconds(0),t.setUTCMilliseconds(0),t.getTime()}((new Date).getTime());n[e]=n[e]||{},n[e][t]=n[e][t]||0,n[e][t]++})),n}(r,i))}));return Promise.all([s,a]).then((()=>null))}(e,o,a.sessionId).then((()=>o))})),saveClosedState(t,i){e.update("precheckoutClosed",(e=>{const n=(e||[]).filter((e=>e.campaign!==t));return n.push({campaign:t,expireAt:Date.now()+i}),n}))},getUtmTags:()=>a.utmTags,getHypotheticalUtmTags:()=>a.utmTagsHypothetical,getCampaigns:()=>a.campaigns,getVariables:()=>a.variables,getTrackingSettings:()=>a.tracking,getVapidPublicKey:()=>a.vapidPublicKey,getPrecheckoutTestSettings:()=>a.precheckoutTest,isProductEnabled:e=>-1!==a.enabledProducts.indexOf(e),isResubscribePushEnabled:()=>a.resubscribePushEnabled,isExternalTrackingDisabled:()=>a.externalTrackingDisabled,update(e,i){let r=a.utmTags;r.source||(r=a.utmTagsHypothetical);const s=(0,t.ak)("flocktory-preview-id",window.location.href);return n.requestData(e,r,i,s).then((e=>{a.campaigns=e.campaigns,a.mutualExclusions=e.exclusions}))}}}))}function Ui(e){return e.get("sessionId").then((t=>{if(t&&t.sessionId&&Date.now()<t.expireAt)return t.sessionId;const i=Ge.v1();return e.set("sessionId",{sessionId:i,expireAt:Date.now()+Ni}).then((()=>i))}))}var ji,Fi=__webpack_require__(554),Mi=__webpack_require__.n(Fi),$i=function(){return $i=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},$i.apply(this,arguments)};!function(e){e.COOKIE="flocktory-uuid",e.LOCAL_STORAGE="flockapi::siteSessionId"}(ji||(ji={}));var Wi=function(e){return(""+e).replace(/-/g,"").split("").map((function(e){return parseInt(e,16)})).join("").split("").reduce((function(e,t,i){var n=Number(t);return i%2||(n=(n*=2)<9?n:n-9),e+n}),0)%10},qi=function(e){return 38===(null==e?void 0:e.length)&&e.slice(-1)===""+Wi(e.slice(0,-2))},zi=function(e){try{localStorage.setItem(ji.LOCAL_STORAGE,e)}catch(e){}var t=new Date(Date.now()+287712e5).toUTCString();document.cookie=ji.COOKIE+"="+e+"; path=/; expires="+t},Bi=function(){var e,t,i;e=$i({},localStorage),t=Object.keys(e).reduce((function(e,t){return t.match(/flockapi:\d+:siteSessionId/)&&(e=t),e}),""),(i=e[t])&&qi(i)&&(zi(i),localStorage.removeItem(t));var n,r,s,o,a=localStorage.getItem(ji.LOCAL_STORAGE),c=(n=ji.COOKIE,(s=null===(r=document.cookie)||void 0===r?void 0:r.match(new RegExp("(^| )"+n+"=([^;]+)")))?s[2]:null),u=a||c;return u&&qi(u)?(a!==c&&zi(u),u):(u=(o=Mi().v4())+"-"+Wi(o),zi(u),u)};const Hi="callback";let Ki=1;function Gi(e){window[e]=()=>null}function Zi(e){const t=document.getElementById(e);null!=t&&document.getElementsByTagName("head")[0].removeChild(t)}function Ji(e,t=4e4){let i=null;return new Promise((n=>{const r="flock_jsonp_"+Ki++,s=Hi+"_"+r;window[r]=e=>{n(e),i&&clearTimeout(i),Zi(s),Gi(r)};const o=e+(-1===e.indexOf("?")?"?":"&"),a=document.createElement("script");a.setAttribute("src",""+o+Hi+"="+r),a.setAttribute("id",s),document.getElementsByTagName("head")[0].appendChild(a),i=setTimeout((()=>{window[r]({error:new Error(`JSONP request to ${e} timed out`)}),Gi(r),Zi(s)}),t)}))}const Qi={getSampleData:(e,t)=>`${e} - ${t}`},Yi={PUSH_SUBSCRIBE:"push-subscribe"},Xi=e=>JSON.parse(JSON.stringify(e)),en=new Ue.EventEmitter,tn=(e,t)=>en.emit(e,Xi(t)),nn={EVENTS:Yi,Promise,on:(e,t)=>en.on(e,t),off:(e,t)=>en.removeListener(e,t),exec:(...e)=>{const[t,...i]=e;if(!t)throw Error("[flocktory.exec]: API method name not specified.");if(!Object.keys(Qi).includes(t))throw Error(`[flocktory.exec]: API method "${t}" does not exist.`);const n=(0,Qi[t])(...i);return window.Promise&&n instanceof Promise?n.then(Xi,Xi):Xi(n)}};window.flocktory=Object.assign(window.flocktory||[],nn);const rn=window.flocktory,sn=(0,e.Z)("backend"),on=(0,e.Z)("performance"),an=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?"firefox":"chrome";function cn(e,i){const{siteId:n}=i,r=Bi();function s(e,t,i=!0){const r=`${function(e,t){try{return JSON.stringify(t)}catch(t){return Promise.reject(`Can't stringify data to ${e}`)}}(e,t)}`;return`https://${function(e){return 2642===e?"sephora.":1632===e?"beeline.":2084===e?"gpb.":2813===e?"vtb.":3382===e?"rosbank.":1962===e?"tele2.":""}(n)}${Ze}${e}${i?".js":""}?body=${encodeURIComponent(r)}`}function o(i){const n=e.isActionAvailable(ve.GET_GLOBAL_SESSION_ID);return(0,t.vs)()&&n?e.getGlobalSessionId().then((e=>`${i}&global-session-id=${encodeURIComponent(e)}`),(e=>(sn.error(e),i))):Promise.resolve(i)}function a(e,t){return o(s(e,t)).then((e=>Ji(e,1e4))).then(((e={})=>{if(e.error){const{error:t}=e;t.schema?sn.error(new Error(t.message||t),t.schema):sn.error(new Error(t.message||t))}return e}))}function c(e){document.createElement("img").setAttribute("src",e)}function u(e,t){o(`${s(e,t)}&callback=flock_jsonp_9999`).then(c)}let l,d;function h(){return a("/u_flockman/check-active-push-subscription",{"site-id":String(n)})}function p(e,t){const{keys:i}=JSON.parse(JSON.stringify(e)),s={};return i&&["auth","p256dh"].forEach((e=>{i[e]&&(s[e]=i[e])})),function(){let e=Promise.resolve(null);if(un)e=Promise.resolve(un);else if("chrome"===an&&"https:"===window.location.protocol){const t=document.querySelector('[rel="manifest"]');if(t){const i=t.getAttribute("href");null!=i&&(e=fetch(i).then((e=>e.json())).then((e=>(un=e.gcm_sender_id,un))))}}return e}().then((i=>{t?s["vapid-public-key"]=t:i&&(s["gcm-sender-id"]=i);const o={platform:t?"vapid":an,"site-id":String(n),token:e.endpoint,url:window.location.href};return 0!==Object.keys(s).length&&(o["provider-meta"]=s),r&&(o["site-session-id"]=String(r)),o}))}return{attachToProfile:function(e){const t={"site-id":String(n),meta:Object.keys(e).reduce(((t,i)=>(t[String(i)]=String(e[i]),t)),{})};return r&&(t["site-session-id"]=String(r)),a("/u_flockman/set-profile-custom-meta",t)},setup:function(e,t=!1){if(!t&&function(e,t){if(!e||!t)return!1;const i=e=>Object.keys(e).sort().map((t=>[t,e[t]])),n=JSON.stringify(i(e)),r=JSON.stringify(i(t));return n===r}(d,e))return Promise.resolve(l);const i={siteId:String(n),utm:e.utm,profile:e.emailProfile};return i["site-session-id"]=String(r),e.previewCampaignId&&(i["preview-campaign-id"]=String(e.previewCampaignId)),on.info("setup-api request start",performance.now()),(r?a("/u_shaman/setup-api",i):Promise.resolve({error:"setup-api request aborted: no uuid"})).then((t=>{var i,n;t.error&&console.warn(t.error),on.info("setup-api request finished",performance.now());const r=null===(i=t.oldCampaigns)||void 0===i?void 0:i.filter((e=>e.widgets.length)).map((e=>(e.widgets=function(e){const t=e.slice(0),i=e=>parseInt(e.meta.weight||0,10);return t.sort(((e,t)=>i(e)-i(t))),t}(e.widgets),e)));return t.campaigns=(null===(n=t.campaigns)||void 0===n?void 0:n.concat(r))||[],t.campaigns.forEach((e=>{if(e.trackRedefinitions=[],null!=e.widget&&e.widget.meta.trackRedefinitions){try{e.trackRedefinitions=JSON.parse(e.widget.meta.trackRedefinitions)}catch(e){}e.trackCategory=e.widget.meta.trackCategory,e.trackLabel=e.widget.meta.trackLabel}if(null!=e.widgets){const t=e.widgets.find((e=>e.meta&&e.meta.noShowCategory));if(null!=t){const{meta:i}=t;e.noShowLabel=i.noShowLabel,e.noShowCategory=i.noShowCategory,e.noShowAction=i.noShowAction}}})),l=t,d=e,t}))},checkActivePushSubscription:function(){return h().then((e=>(0,t.U2)(e,"subscribed",null)))},getSubscriptionStatus:h,attachPushToSession:function(e,t,i){return p(e,i).then((n=>(n["campaign-id"]=t,a("/u_flockman/attach-push-to-session",n).then((n=>(tn(Yi.PUSH_SUBSCRIBE,{subscription:e,cid:t,vapidPublicKey:i,pushProfile:n}),n.id))))))},resubscribePush:function(e,t,i){return p(e,i).then((e=>(e["old-token"]=(t||{}).endpoint,a("/u_flockman/resubscribe-push",e).then((e=>e.id)))))},ultimate:function(e){const t={data:e};r&&(t["site-session-id"]=String(r)),u("/underworld/tracks/ultimate",t)},customActivity:function(e,t){const i={data:e,"site-id":String(n),"campaign-id":String(t),label:"precheckout-event"};r&&(i["site-session-id"]=String(r)),u("/u_shaman/custom-activity",i)},assigns:function(e,t){return t.site_id=n,a("/u_widget/get-assigns",{assigns:e,params:Object.keys(t).map((e=>({key:e,value:String(t[e])})))}).then((e=>e.assigns.reduce(((e,t)=>(e[t.key]=t.value,e)),{})))},userMeta:function(){return a("/u_flockman/get-user-metainfo",{scope:`site-custom:${n}`}).then((e=>(e.meta||[]).reduce(((e,t)=>(e[t.key]=t.value,e)),{})))},customEvent:function(e){const t={event:e,"site-id":String(n)};r&&(t["site-session-id"]=String(r)),u("/u_shaman/custom-events",t)},exchangeBanner:function(e){const t={"source-site-id":String(n)};return null!=e.spot&&(t.spot=e.spot),null!=e.name&&(t.name=e.name),null!=e.email&&(t.email=e.email),r&&(t["site-session-id"]=String(r)),a("/interchange/v1/banner",t).then((e=>{if(e.error)throw new Error(e.error);if(e.errors&&e.errors[0])throw new Error(e.errors[0]);if(e.errors)throw new Error(e.errors);return{html:e.html,loginData:e["login-data"],selector:e.selector}}))},trackExchangeBanner:function(e){o(`https://${Ze}/interchange/v1/banner/track-display?data=${encodeURIComponent(e)}`).then(c)},postcheckout:function(e,i){const s=(e.order&&e.order.items||[]).reduce(((e,t,i)=>{const n=Object.assign({},t);return["id","title","image","count","price"].forEach((e=>{delete n[e]})),e[String(i)]={i:t.id,t:t.title,u:t.image,c:t.count,p:t.price,custom_data:n},e}),{}),o=Ct(String.prototype.slice.call(document.cookie)),c={site_id:n,jsapi_version:"2.0",i:e.order.id,e:e.user&&e.user.email,n:e.user&&e.user.name,p:e.order&&e.order.price,c:e.order&&e.order.custom_field,sp:e.spot,s:e.user&&e.user.sex?e.user.sex.slice(0,1):void 0,t:s,ga:{utmcsr:o.utmz.utmcsr||i.source,utmccn:o.utmz.utmccn||i.campaign,utmcmd:o.utmz.utmcmd||i.medium,utmctr:o.utmz.utmctr,pageviews:o.utma.pageViews,previous_visit_ts:o.utma.previousVisitTs,current_visit_at:o.utma.currentVisitTs}};return r&&(c["site-session-id"]=String(r)),a("/1/postcheckout/offer",c).then((e=>{if(e.error)throw new Error(e.error);if(e.errors&&e.errors[0])throw new Error(e.errors[0]);if(e.errors)throw new Error(e.errors);return{html:e.html,cid:e.campaign_id,title:e.campaign_title,timeout:e.js_options.params.timeout,el:(0,t.U2)(e,"js_options.params.widget.el","popup"),background:(0,t.U2)(e,"js_options.params.widget.background",null)}}))},widget:function({cid:e,vid:t,motivationId:i}){const r={"version-id":t,locale:"ru","site-id":String(n),"campaign-id":String(e),flags:["render"],params:[{key:"campaign_id",value:String(e)},{key:"attach_key",value:"campaign"},{key:"attach_value",value:String(e)}],"extra-params":void 0};return null!=i&&r.params.push({key:"motivation_id",value:i}),on.info(`widget ${e} request started`,performance.now()),a("/u_widget/get-widget",r).then((i=>(on.info(`widget ${e} request finished`,performance.now()),{cid:e,vid:t,html:i.response.content})))},trackCustomerActions:function(e,t,i,n,s){const o={};return o["campaign-id"]=String(e),null!=t&&(o.email=String(t)),null!=i&&(o.name=String(i)),null!=n&&(o.data=Object.keys(n).map((e=>({key:e,value:n[e]})))),null!=s&&(o["make-offer"]=s),r&&(o["site-session-id"]=String(r)),a("/u_shaman/track-customer-actions",o).then((e=>{if(e.error)throw new Error(e.error);return e}))},getMotivation:function(e){const{motivationId:t,sid:i,cid:n,cacheTime:s}=e,o={"motivation-id":String(t),options:[{key:"campaign",value:String(n)},{key:"as-link",value:"true"},{key:"page-type",value:"iframe"},{key:"away-site",value:String(i)}]};return s&&o.options.push({key:"profile-cache",value:String(s)}),r&&(o["site-session-id"]=String(r)),a("/u_shaman/make-reward",o).then((e=>{if(e){const t=e["link-to-exchange"]||e["link-to-coupon"];return{link:t.url,code:t.code}}return{}}))},getUuid:function(){return r},sendCheckpointId:function(e){c(s("/u_shaman/set-checkpoint",{"checkpoint-id":e,"site-session-id":String(r)},!1))},checkSkuInAudience:function({audienceIds:e,currentItemId:t}){return a("/u_audiencer_api/sku-exist",{"audience-ids":e.map(Number),"sku-id":t})}}}let un=null;const ln=(e,t)=>{for(const i in t){let n=String(t[i]);"zIndex"===i||isNaN(Number(n))||""===n||(n=`${n}px`),e.style[i]=n}},dn=e=>e.split("|").map((e=>`drop-shadow(${e.trim()})`)).join(" "),hn=e=>e.replace(/drop-shadow\((?:[^)(]+|\([^)(]*\))*\)/g,""),pn=(e,t)=>{const i=e?.contentDocument,n=i?.body;if(!i||!n)return["0","0"];const r=t.style,s=n.style,{display:o,visibility:a}=r,{position:c,display:u}=s;t.dataset.showedUp||(r.visibility="hidden"),r.display="block",s.display="block",s.position="absolute";const{offsetWidth:l,offsetHeight:d}=n;return r.display=o,t.dataset.showedUp||(r.visibility=a),s.display=u,s.position=c,n.dataset.mutation=String((Number(n.dataset.mutation)||1)+1),[`${l}px`,`${d}px`]},mn=(e,t,i)=>{if("auto"!==i)return String(i);const[n]=pn(e,t);return n},gn=(e,t,i)=>{if("auto"!==i)return String(i);const{height:n}=e.style;ln(e,{height:"0"});const[,r]=pn(e,t);return ln(e,{height:n}),r};class fn{constructor(e,t){this.siteId=e,this.campaignId=t,this.storageName=`flockapi:${e}:widgetStorage`,this.campaignId=t,this.clearOutdatedValues()}getSiteData(){const e=localStorage.getItem(this.storageName);try{return e?JSON.parse(e):{}}catch(e){return{}}}setSiteData(e){const t=JSON.stringify(e);localStorage.setItem(this.storageName,t)}setValueByName(e,t,i){const n=this.getSiteData();n[`${this.campaignId}:${e}`]={value:t,expired:i||Date.now()+18e5},this.setSiteData(n)}getValueByName(e){const t=this.getSiteData(),i=`${this.campaignId}:${e}`;return t[i]?t[i]:void 0}clearOutdatedValues(){const e=this.getSiteData();for(const t in e){const i=e[t]||{};i?.expired<=Date.now()&&delete e[t]}this.setSiteData(e)}}class wn{constructor(e){this.frame=e,this.frame=e,this.overlay=e.parentElement,this.set=this.set.bind(this),this.setPopupType=this.setPopupType.bind(this),this.setFixedType=this.setFixedType.bind(this),this.setEmbeddedType=this.setEmbeddedType.bind(this)}set(e){const{type:t}=e;switch(t){case"popup":this.setPopupType(e);break;case"fixed":this.setFixedType(e);break;case"embedded":this.setEmbeddedType(e)}}setPopupType(e){const{width:t="auto",height:i="auto",overlayBackground:n="rgba(0, 0, 0, 0.8)",dropShadow:r}=e,s=this.frame?.contentDocument,o=s?.body;o.dataset.mutation=o.dataset.mutation||"1",ln(this.overlay,{position:"fixed",top:"0px",left:"0px",zIndex:"2147483647",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",background:n,transform:"none"});const[a,c]=pn(this.frame,this.overlay),{innerWidth:u,innerHeight:l}=window;if(ln(this.frame,{width:String("auto"===t?Math.min(parseInt(a,10),u):t),height:"auto"===i?c:String(i)}),r){const{filter:e}=this.frame.style;ln(this.frame,{filter:`${hn(e)} ${dn(r)}`})}parseInt(c,10)>l&&(ln(this.overlay,{alignItems:"flex-start",overflowY:"scroll"}),ln(this.frame,{position:"static",top:"auto",left:"auto",display:"block",margin:"0 auto",transform:"none"}))}setFixedType(e){const{position:t,top:i,right:n,bottom:r,left:s,zIndex:o="auto",width:a="auto",height:c="auto",overlayBackground:u="none",dropShadow:l}=e;if(ln(this.overlay,{position:"fixed",zIndex:String(o),justifyContent:"initial",alignItems:"initial",width:mn(this.frame,this.overlay,a),height:gn(this.frame,this.overlay,c),background:u,transform:"translateZ(0px) scale(1, 1)",backfaceVisibility:"hidden"}),ln(this.frame,{width:"100%",height:"100%"}),l){const{filter:e}=this.frame.style;ln(this.frame,{filter:`${hn(e)} ${dn(l)}`})}if(t){const[e,o]=(e=>{if("center"===e)return["center","center"];const[t,i]=e.split("-");return[t,i]})(t);let a=this.overlay.style.transform;switch(e){case"top":ln(this.overlay,{top:i?String(i):"0",bottom:"auto"});break;case"bottom":ln(this.overlay,{top:"auto",bottom:r?String(r):"0"});break;case"center":ln(this.overlay,{top:"50%",transform:`${a} translateY(-50%)`})}switch(a=this.overlay.style.transform,o){case"right":ln(this.overlay,{right:n?String(n):"0",left:"auto"});break;case"left":ln(this.overlay,{right:"auto",left:s?String(s):"0"});break;case"center":ln(this.overlay,{left:"50%",transform:`${a} translateX(-50%)`})}}else ln(this.overlay,{top:i?String(i):"auto",right:n?String(n):"auto",bottom:r?String(r):"auto",left:s?String(s):"auto"})}setEmbeddedType(e){const{zIndex:t="auto",width:i="auto",height:n="auto",overlayBackground:r="none",dropShadow:s}=e;if(ln(this.overlay,{position:"relative",zIndex:String(t),justifyContent:"initial",alignItems:"initial",width:mn(this.frame,this.overlay,i),height:gn(this.frame,this.overlay,n),background:r}),ln(this.frame,{width:"100%",height:"100%"}),s){const{filter:e}=this.frame.style;ln(this.frame,{filter:`${hn(e)} ${dn(s)}`})}}}class vn{constructor(e,t,i,n,r,s,o,a,c,u,l,d,h,p){this.frame=e,this.siteId=t,this.campaignId=i,this.tracker=n,this.pushService=r,this.pushOptinVersionId=s,this.logger=o,this.backend=a,this.motivationId=c,this.state=u,this.trigger=l,this.widgetState=d,this.readyQueue=h,this.configurations=p,this.frame=e,this.siteId=t,this.campaignId=i,this.tracker=n,this.pushService=r,this.pushOptinVersionId=s,this.logger=o,this.backend=a,this.motivationId=c,this.state=u,this.trigger=l,this.widgetState=d,this.readyQueue=h,this.configurations=p,this.overlay=e.parentElement,this.widgetStorage=new fn(this.siteId,this.campaignId),this.widgetConfig=new wn(this.frame),this.setValue=this.setValue.bind(this),this.getValue=this.getValue.bind(this),this.getData=this.getData.bind(this),this.getMeta=this.getMeta.bind(this),this.track=this.track.bind(this),this.setScreen=this.setScreen.bind(this),this.pushStatus=this.pushStatus.bind(this),this.pushSubscribe=this.pushSubscribe.bind(this),this.getMotivation=this.getMotivation.bind(this),this.sendError=this.sendError.bind(this),this.collectEmail=this.collectEmail.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.ready=this.ready.bind(this),this.configure=this.configure.bind(this)}setValue(e,t,i){this.widgetStorage.setValueByName(e,t,i)}getValue(e){return this.widgetStorage.getValueByName(e)}getData(){return{cid:this.campaignId,siteId:this.siteId}}getMeta(){const e=this.frame.contentDocument;return[].slice.call(e.querySelectorAll("meta[data-fl-param]")).reduce(((e,t)=>{const{name:i,content:n,dataset:{flParam:r}}=t;let s;switch(r){case"boolean":s="true"===n;break;case"number":s=parseFloat(n);break;default:s=n}return e[i]=s,e}),{})}track(e,t=!1){this.tracker.track(e,t)}setScreen(e){const t=this.frame.contentDocument,i=[].slice.call(t.querySelectorAll("[data-fl-screen]")),n=i.find((t=>t?.dataset?.flScreen===e));if(!n)throw new Error(`No screen ${e}`);i.forEach((e=>e.style.display="none")),n.style.display="block",this.track(`show-screen-${e}`)}pushStatus(e){return this.pushService.status?this.pushService.status({cid:this.campaignId,alwaysUseTwoStep:e?.alwaysUseTwoStep||!1}):(this.tracker.track("push-unsupported",!0),Promise.resolve({permission:"unsupported",requireInteraction:!1}))}pushSubscribe(e){return this.pushService.subscribe?this.pushService.subscribe({cid:String(this.campaignId),optinVersionId:this.pushOptinVersionId,alwaysUseTwoStep:e?.alwaysUseTwoStep||!1,isUserInteraction:e?.isUserInteraction||!1}):(this.tracker.track("push-unsupported",!0),Promise.resolve({permission:"unsupported",requireInteraction:!1}))}getMotivation(e){if(!this.motivationId)return this.logger.error(new Error(`${this.siteId}:${this.campaignId} | Missing critical assigns: motivation`)),Promise.resolve({});const t={motivationId:this.motivationId,sid:this.siteId,cid:this.campaignId,cacheTime:e||0};return this.backend.getMotivation(t)}sendError(e=""){this.logger.error(new Error(`${this.siteId}:${this.campaignId} | ${e}`))}collectEmail(e,t,i={light:"true"},n=!1){for(const e in i)if("string"!=typeof i[e])throw new Error(`Value of data[${e}] must be string type`);const r=this.state.getUtmTags(),s={};for(const e in r){s[`utm_${e}`]=r[e]}return this.backend.trackCustomerActions(this.campaignId,e,t,{...i,...s},n).then((n=>{if(e&&this.tracker.track("login",!1),window.dataLayer){const n={...i};delete n.light,window.dataLayer.push({event:"fl_collected_email",campaignLabel:this.tracker.campaign.trackLabel,email:e,name:t,additionalFields:n,...s})}return n}))}hide(e){if(this.overlay.style.display="none",0!==e){const t=1e3*(e||1800);this.state.saveClosedState(this.campaignId,t)}}show(){!this.overlay.dataset.showedUp&&this.trigger.state.expired||(this.overlay.style.display="flex",this.overlay.dataset.showedUp="true",this.tracker.track("show-widget",!0))}ready(e){return void 0!==e&&(this.widgetState.ready?e():this.readyQueue.push(e)),this.readyQueue}configure(e){const t={...this.configurations.get(this.frame)||{},...e};this.configurations.set(this.frame,t),this.widgetConfig.set(t)}}class yn{constructor(e,t,i,n,r,s,o,a,c,u){this.siteId=e,this.pushService=t,this.logger=i,this.backend=n,this.configurations=r,this.state=s,this.zIndex=o,this.apis=a,this.overlays=c,this.topWindow=u,this.siteId=e,this.pushService=t,this.logger=i,this.backend=n,this.configurations=r,this.state=s,this.zIndex=o,this.apis=a,this.overlays=c,this.topWindow=u,this.create=this.create.bind(this),this.destroy=this.destroy.bind(this),this.setupFrame=this.setupFrame.bind(this),this.initApi=this.initApi.bind(this)}create(e,t){const{cid:i,html:n}=e,{root:r,closeOutside:s,closeOutsideSeconds:o,gaTracker:a,optinVersionId:c,motivationId:u,trigger:l}=t,d={ready:!1},{overlayElement:h,frameElement:p,frameDocument:m}=this.setupFrame(i,r),g=this.initApi(p,this.siteId,i,a,this.pushService,c,this.logger,this.backend,u,this.state,l,d,[],this.configurations);this.apis.set(p,g),this.pushService&&this.pushService.emitter&&this.pushService.emitter.on("push-status",((e,t,n=!1)=>e===i&&g.track(t,n))),p.addEventListener("load",(()=>{const e=m.querySelector('meta[name="widget-config"]'),t=[].slice.call(m.querySelectorAll("[data-fl-track], [data-fl-close]")),i=e=>{const t=this.configurations.get(p),i=(e||[]).some((e=>"data-mutation"===e?.attributeName));t&&!i&&g.configure(t)};if(yn.initScreens(m,g.track),e&&yn.applyInnerConfig(e,g.configure,g.show),t.length&&yn.setupTrackableElements(t,g.hide,g.track),s){const e=t=>{t.stopPropagation(),g.hide(o),g.track("click-outside"),h.removeEventListener("click",e)};h.addEventListener("click",e)}((e,t)=>{const i=e?.contentDocument,n=i?.body;if(!i||!n)return;new MutationObserver(t).observe(n,{subtree:!0,attributes:!0,characterData:!1,childList:!1})})(p,i),this.topWindow.addEventListener("resize",(()=>i())),!l.state.expired&&g.ready().forEach((e=>e())),d.ready=!0})),yn.fillFrame(m,n,g)}destroy(){this.overlays.forEach((e=>e.remove()))}setupFrame(e,t){const i=document.createElement("div"),n=document.createElement("iframe");i.classList.add("flocktory-widget-overlay"),i.style.display="none",i.style.zIndex=String(this.zIndex++),n.id=`fl-${e}`,n.title="Flocktory widget",n.frameBorder="0",n.scrolling="no",n.classList.add("flocktory-widget"),i.append(n),t?t.append(i):document.body?document.body.append(i):this.logger.error(new Error("document.body eq null"));const r=n?.contentDocument,s=r?.documentElement;return s&&(s.style.transform="translateZ(0) scale(1, 1)"),{overlayElement:i,frameElement:n,frameDocument:r}}initApi(e,t,i,n,r,s,o,a,c,u,l,d,h,p){const{setValue:m,getValue:g,getData:f,getMeta:w,track:v,setScreen:y,pushStatus:b,pushSubscribe:_,getMotivation:k,sendError:S,collectEmail:E,hide:I,show:A,ready:T,configure:O}=new vn(e,t,i,n,r,s,o,a,c,u,l,d,h,p);return{setValue:m,getValue:g,getData:f,getMeta:w,track:v,setScreen:y,pushStatus:b,pushSubscribe:_,getMotivation:k,sendError:S,collectEmail:E,hide:I,show:A,ready:T,configure:O}}static fillFrame(e,t,i){const n=`<script>window.widget = {};${Object.keys(i).map((e=>`window.widget.${e} = function() {\n            return window.parent.flocktory.wapi(window.frameElement, '${e}', arguments);\n          };`)).join("\n")}Object.freeze(window.widget);<\/script>`;e.open(),e.write(n),e.write(t),e.close()}static initScreens(e,t){const i=[].slice.call(e.querySelectorAll("[data-fl-screen]"));if(i.length<2)return;const n=i[0],r=n.dataset.flScreen;i.forEach((e=>e.style.display="none")),n.style.display="block",t(`show-screen-${r}`,!0)}static applyInnerConfig(e,t,i){const n=JSON.parse(JSON.stringify(e.dataset));t(n),"true"===n.autoshow&&i()}static setupTrackableElements(e,t,i){e.forEach((e=>{e.addEventListener("click",(e=>{const n=e.currentTarget,r=(e=>{for(;e;){const t=e.getAttribute("data-fl-close");if(null!==t){if(""===t)return 1800;const e=parseInt(t,10);return isNaN(e)?0:e}e=e.parentElement}return null})(n),s=(e=>e.dataset.flTrack||e.dataset.flTrackGa||e.getAttribute("fl-track-ga")||null)(n);(e=>"A"===e.tagName&&!!e.getAttribute("href")&&"_top"===e.getAttribute("target"))(n)&&e.defaultPrevented&&(e.preventDefault(),setTimeout((()=>{window.location.href=n.getAttribute("href")}),300)),null!==r&&(t(r),null===s&&i("close")),null!==s&&i(s)}))}))}}const bn=(0,e.Z)("widgets"),_n=(0,t.b3)();function kn(e,i,n,r,s,o){(0,t.hu)(e&&i&&n,"Args");const a=new WeakMap,c=new WeakMap,{siteId:u}=e,{getMotivation:l,trackCustomerActions:d}=r;r={trackCustomerActions:new Proxy(d,{apply:(e,t,i)=>new Promise((t=>{const[,r]=i;t(e(...i).then((e=>(r&&o.set(Ye.isUserSubscribed,{sessionId:n.getSessionId(),isSubscribed:!0}),e))))}))}),getMotivation:l},window.flocktory.wapi=(e,t,i)=>{const n=a.get(e);return null!=n?n[t].apply(null,i):null};const h=new yn(u,s,bn,r,c,n,2e9,a,[],_n);return{create:h.create,destroy:h.destroy}}function Sn(e,i,n,r){(0,t.hu)(e&&n,"setup args");const{siteId:s}=n;function o(t,n,r,s){const o={utm:n,emailProfile:void 0};t.email&&(o.emailProfile={email:t.email,name:t.name||void 0}),s&&(o.previewCampaignId=s);const a=e.setup(o,r);return a.then((e=>i.setSetupApiData(e))),a}let a;try{const e=localStorage.getItem((0,t.eM)(`${s}`)("utmTags"));null!=e&&(a=JSON.parse(e))}catch(e){}const[c,u]=Li(document.cookie,(0,t.mx)(),a,document.referrer);let l,d;Array.from(document.querySelectorAll("[data-fl-user-name], [data-fl-user-email]")).forEach((e=>{l=l||e.dataset.flUserName,d=d||e.dataset.flUserEmail})),r.forEach((e=>{let t={};Array.isArray(e)&&e[1]?t=e[1]:e&&(t=e);const{user:i}=t;i&&(i.name&&(l=i.name),i.email&&(d=i.email))}));return o({name:l,email:d},c.source?c:u,!1,(0,t.ak)("flocktory-preview-id",window.location.href)).then((e=>({requestData:o,getInitialConfig:()=>e})))}const En=26784e5,In=(0,e.Z)("push service"),An="https:"===window.location.protocol,Tn=new(je().EventEmitter);function On(e,t,i,n,r){if(!t.isProductEnabled("push_api"))return Promise.resolve(null);if(!function(){const e=navigator.userAgent;return function(){function e(e,t){const i=t.match(e);return i&&i.length>0&&i[1]||""}const t=[{name:"Opera",regExp:/opr\/|opios/i,checkVersion(t){const i=e(/(?:opr|opios)[\s/](\S+)/i,t)||e(/version\/(\d+(\.?_?\d+)+)/i,t);return!!i&&parseInt(i,10)>55}},{name:"Firefox",regExp:/firefox|iceweasel|fxios/i,checkVersion(t){const i=e(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return!!i&&parseInt(i,10)>62}},{name:"Chrome",regExp:/chrome|crios|crmo/i,checkVersion(t){const i=e(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return!!i&&parseInt(i,10)>68}}];return t.some((e=>!!e.regExp.test(navigator.userAgent)&&e.checkVersion(navigator.userAgent)))}()||"serviceWorker"in navigator&&"showNotification"in ServiceWorkerRegistration.prototype&&"PushManager"in window&&-1===e.indexOf("YaBrowser/15.12.1.6476")&&!/\YaBrowser\/[0-9\.]+ \(beta\)/.test(e)}())return Promise.resolve(null);const s=t.getVapidPublicKey(),o=function(e){if(!e)return null;const t="=".repeat((4-e.length%4)%4),i=(e+t).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(i),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}(s),{siteId:a}=n;let c=null;const u=navigator.serviceWorker;function l(e){return(t,i=!1)=>Tn.emit("push-status",e,t,i)}function d({resubscribe:n,cid:u,optinVersionId:d=null,alwaysUseTwoStep:h=!1,isUserInteraction:p=!1,oldSubscription:m=null}){const g=l(u),f=e=>n?i.resubscribePush(e,m,s):i.attachPushToSession(e,u,s);if(!An||h){const i=t.getSubdomain();return null!=i?function(e,t,i){const{subdomain:n,siteId:r,optinVersionId:s,vapidPublicKey:o}=e,a="menubar=no,location=no,resizable=no,scrollbars=no,status=no,width=640,height=580,left=300,top=0",c="Push notification";let u=`https://${n}/p/push/subscribe/${r}/push-settings-popup?site_id=${r}`;s&&(u+=`&optin_version_id=${s}`);o&&(u+=`&vapid=${o}`);const l=window.open(u,c,a);return new Promise((e=>{window.addEventListener("message",s);const n=setInterval((()=>{l.closed&&(Tn.emit("push-status",t,"push-window-close"),window.removeEventListener("message",s),clearInterval(n))}),200);function r(){return clearInterval(n),l.close(),window.removeEventListener("message",s)}function s(t){if(!/^pusher /.test(t.data))return;let n;try{n=JSON.parse(t.data.slice(7))}catch(e){return}if(!n||"show"!==n.state)return n&&"close"===n.state?(i("close-request-subdomain"),r(),void e({close:!0})):void(n&&["subscribed","denied","error"].includes(n.state)&&(r(),e({subscription:n.subscription||null})));i("show-request-subdomain")}}))}({siteId:a,subdomain:i,optinVersionId:d,vapidPublicKey:s},u,g).then((({subscription:t,close:i})=>i?{permission:"default"}:null==t?(e.set("pushDenied",!0),g("push-denied-subdomain"),{permission:"denied",requireInteraction:!1}):(f(t).then(Ln),g("push-subscribed-subdomain"),{permission:"granted",requireInteraction:!1}))):(In.error(new Error("no subdomain on http push")),Tn.emit("push-status",u,"push-error"),Promise.resolve({permission:"denied",requireInteraction:!1}))}Pn();const w=window.Notification.permission;return"denied"===w?(g(p?"push-denied-domain":"push-denied"),Promise.resolve({permission:w,requireInteraction:!1})):("granted"!==w&&(p?g("show-request-domain"):g("system-show",!0)),c?c.then((t=>{const i=s?{userVisibleOnly:!0,applicationServerKey:o}:{userVisibleOnly:!0};return t.pushManager.subscribe(i).catch((e=>{let r;return r=n&&e.code===e.INVALID_STATE_ERR?t.pushManager.getSubscription().then((e=>e.unsubscribe())).then((()=>t.pushManager.subscribe(i))):Promise.reject(e),r})).then((t=>null==t?(e.set("pushDenied",!0),g(p?"push-denied-domain":"system-push-denied"),{permission:"denied"}):(f(t).then(Ln).then((()=>r.push.saveLastSubscriptionTimestamp())),"granted"===w?g("system-push-re-subscribed",!0):g(p?"push-subscribed-domain":"system-push-subscribed"),{permission:"granted"}))).catch((t=>{if("default"===window.Notification.permission)return g(p?"close-request-domain":"system-close"),{permission:"default"};const i=t instanceof window.DOMException;return t.code!==t.ABORT_ERR&&0!==t.code||!i?(In.error(t,"ChromePushManager: requestPush error"),g("push-error")):(e.set("pushDenied",!0),g(p?"push-denied-domain":"system-push-denied")),{permission:"denied"}}))})):Promise.resolve({permission:window.Notification.permission}))}return An&&u&&(c=u.register(t.getWorkerPath(),{scope:Cn(t.getWorkerPath())}).then((e=>e.active?Promise.resolve(e):new Promise((t=>{let i=null;const n=()=>{i&&"activated"===i.state&&t(e)};e.onupdatefound=()=>{i=e.installing,i.onstatechange=n}})))).catch((e=>In.error(new Error("failed to start serviceWorker on https. "+e))))),An&&t.isResubscribePushEnabled()&&t.isProductEnabled("push_api")&&r.push.getLastSubscriptionTimestamp().then((e=>{let t=!1;const i="granted"===window.Notification.permission;e?e+En<=+new Date&&i&&(t=!0):i&&(t=!0),t&&c.then((e=>e.pushManager.getSubscription())).then((e=>d({resubscribe:!0,cid:"api",optinVersionId:null,alwaysUseTwoStep:!1,isUserInteraction:!1,oldSubscription:e})))})),Promise.resolve({status:function({cid:t,alwaysUseTwoStep:n=!1}){const r=l(t);if(!An||n)return e.get("pushDenied").then((e=>e?(r("push-already-denied",!0),{permission:e?"denied":"default",requireInteraction:!0}):i.checkActivePushSubscription().then((e=>{const t=e?"granted":"default";return"granted"===t&&r("push-already-subscribed",!0),{permission:t,requireInteraction:!0}}))));if(Pn(),"default"!==window.Notification.permission){const e="granted"===window.Notification.permission?"push-already-subscribed":"push-already-denied";return r(e,!0),Promise.resolve({permission:window.Notification.permission,requireInteraction:!1})}return c?c.then((e=>e.pushManager.getSubscription())).then((e=>(null!=e&&i.attachPushToSession(e,t),{permission:"default",requireInteraction:"https:"!==window.location.protocol}))):Promise.resolve({permission:window.Notification.permission})},subscribe:d,emitter:Tn})}function Cn(e){return e.split("/").slice(0,-1).join("/")+"/flocktory-cloud-messaging-push-scope"}function Pn(){try{if(!window.document.querySelector("link[rel=manifest]")){const e=document.createElement("link");e.setAttribute("href","/manifest.json"),e.setAttribute("rel","manifest");const t=document.querySelector("head");if(null==t)throw new Error("No head");t.appendChild(e)}}catch(e){In.error(e,"Inser manifest error")}}function Ln(e){(0,t.N2)()&&window.dataLayer.push({event:"fl_push_profile",profile_id:`p${e}`})}const xn=(0,e.Z)("safari-push"),Nn=new(je().EventEmitter);function Dn(e,t,i,n){const{siteId:r}=n,s="web.com.flocktory."+r;return{status:function({cid:e}){if("denied"===window.Notification.permission)return Nn.emit("push-status",e,"push-already-denied"),Promise.resolve({permission:"denied",requireInteraction:!1});const{permission:t}=window.safari.pushNotification.permission(s);return"granted"===t&&Nn.emit("push-status",e,"push-already-subscribed"),Promise.resolve({permission:t,requireInteraction:!1})},subscribe:function(e){const{cid:n,isUserInteraction:o}=e;if("denied"===window.Notification.permission)return Nn.emit("push-status",n,"push-already-denied"),Promise.resolve({permission:"denied",requireInteraction:!1});const{permission:a}=window.safari.pushNotification.permission(s);if("denied"===a)return Nn.emit("push-status",n,"push-already-denied"),Promise.resolve({permission:"denied",requireInteraction:!1});const c=t.getIp();return o?Nn.emit("push-status",n,"show-request-domain"):Nn.emit("push-status",n,"system-show",!0),function(e){const{siteId:t,uuid:i,cid:n,ip:r,isUserInteraction:s}=e;return new Promise(((e,o)=>{setTimeout(o,6e4),window.safari.pushNotification.requestPermission(`https://${Ze}/p/push/sites/${t}`,`web.com.flocktory.${t}`,{"site-id":String(t),authenticationToken:`${t}|${i}|${n}|${r}`,platform:"safari",userAgent:window.navigator.userAgent,referrerURL:window.location.href},(({permission:t})=>{let i;i=s?"granted"===t?"push-subscribed-domain":"push-denied-domain":"granted"===t?"system-push-subscribed":"system-push-denied",Nn.emit("push-status",n,i),e({permission:t,requireInteraction:!1})}))}))}({siteId:r,cid:n,uuid:i.getUuid(),ip:null!=c?c:"",isUserInteraction:o}).catch((e=>(xn.error(e,"request failed"),Nn.emit("push-status",n,"push-error"),{permission:"denied",requireInteraction:!1})))},emitter:Nn}}class Rn{constructor(e){this._key="audience_has_current_item",this._skuCheckRequestStatus={},this._skuCheckResult={},this._audienceIds=[],this._backend=e}getKey(){return this._key}set(e){const i="$and",n="$or",r={[i]:n,[n]:i},s=(e,i)=>{const n=r[i];e[i].forEach((e=>{var t,i;(null==e?void 0:e[n])?s(e,n):(null==e?void 0:e[this._key])&&((null===(t=e[this._key])||void 0===t?void 0:t.$has)&&(this._audienceIds=[...e[this._key].$has,...this._audienceIds]),(null===(i=e[this._key])||void 0===i?void 0:i.$hasNot)&&(this._audienceIds=[...e[this._key].$hasNot,...this._audienceIds]))})),this._audienceIds=(0,t.jj)(this._audienceIds)};e.forEach((e=>{const{triggers:t}=e;(null==t?void 0:t[n])?s(t,n):(null==t?void 0:t[i])&&s(t,i)}))}checkSku(e){return Object.keys(this._skuCheckResult).length?this._skuCheckResult:(this._skuCheckRequestStatus[e]||(this._backend.checkSkuInAudience({audienceIds:this._audienceIds,currentItemId:e}).then((e=>{this._skuCheckResult=e})),this._skuCheckRequestStatus[e]=!0),null)}}function Vn(e){return new Rn(e)}const Un=(0,e.Z)("Flocktory system"),jn=(0,e.Z)("performance"),Fn="flocktory-checkpoint-sent";function Mn(e,i){let n,r={};"string"==typeof e?n=e:Array.isArray(e)?(n=e[0],r=e[1]):(n=e.action,delete e.action,r=e),i[n]&&i[n]((0,t.RH)({},r))}const $n=(0,e.Z)("loader"),Wn=(0,e.Z)("performance");Wn.info("api start",performance.now());const qn=function(){const e=window.navigator.userAgent,t=e.indexOf("Opera Mini")>-1,i=e.indexOf("Presto")>-1,n=e.indexOf("IEMobile/10.0")>-1,r=e.match(/MSIE\s(\d+)/),s=parseInt(r&&r[1],10),o=!Number.isNaN(s)&&s<11,a=e.indexOf("SlimerJS")>-1,c="function"==typeof window.WeakMap,u=e.toLowerCase().indexOf("bot")>-1;return!t&&!i&&!n&&!o&&!(-1!==[].indexOf(1))&&!function(){try{const e="flockCS";localStorage.setItem(e,"i"),localStorage.removeItem(e)}catch(e){return!0}return!1}()&&!a&&c&&!u}(),zn=rn.siteId||function(){const e=Array.from(document.querySelectorAll("script[src]")).map((e=>e.getAttribute("src")||"")).find(t.F5);if(e){const t=e.match("site_id=([0-9]+)");if(t&&t[1])return parseInt(t[1],10)}return null}();rn.loaded?$n.warn("flocktory loader already executed"):zn?qn?(rn.loaded=!0,function(o,a){var c;!function(){try{const i=JSON.parse(window.localStorage.getItem("flocktoryDebug")).log||{};(0,t.hj)(i.level)&&e.Z.setLevel(i.level);const n=i.levels||{};(0,t.M6)(n,((t,i)=>{(0,e.Z)(i).setLevel(t)}))}catch(e){}}(),c=o,["postcheckout","precheckout","exchange","addData","fireEvent","trackItemView","trackCategoryView","getData","updateCart","removeFromCart","addToCart","addToFavorites","removeFromFavorites","updateFavorites"].forEach((e=>{c[e]=t=>c.push([e,t])}));const u=[];o.ready=e=>u.push(e),o.Promise=Promise;const{siteId:l}=a;l||Un.warn("No site id");const d=document.createElement("style");d.id="flocktoryStyleTag",d.type="text/css",d.innerHTML=String('.flockapi-overlay_popup{background-color:#00000080;background-image:radial-gradient(ellipse closest-corner at 50% 50%,#0000004d 20%,#0009 100%);bottom:0;display:none;left:0;opacity:0;outline:0;overflow-x:auto;overflow-y:auto;position:fixed;right:0;top:0;z-index:100000}.flockapi-overlay_popup .flockapi-spinner{display:block}.flockapi-overlay_popup.flockapi-loaded .flockapi-spinner{display:none}.flockapi-wrapper{position:relative}.flockapi-wrapper_popup{display:none;margin:0 auto;opacity:0;position:relative;transform:scale(.8);transition:all .2s linear;z-index:1}.flockapi-wrapper_popup .flockapi-closebutton{right:20px;top:20px}.flockapi-wrapper_popup.flockapi-shown{transition-property:margin,left,top,transform,opacity}.flockapi-closebutton{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAASCAYAAAC5DOVpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAArNJREFUeNp8lDtv1EAUhWfmztheZ0MIibajQCAolgYJJBoQDRKiCH+ZEikQaGgCAaHQJEQhT7L2vDjHuw6bEJiV7bHn3u++V18bDkdam8dKqSKrvGe0fq2UVjFF3KdLa61yzt2edzHS7VLOz7TSq3hpc05vZDAYPCmcW3bWZWP0akppBPUvVJ6HzS+jDR/PnXM3oZuMmBpGlmRxOLxVlWVTuOIEFht8XAHwDmBfgYhXwErA1pwrlgZluV8U0BPTQD7KsF5QZVFcF5EAC8EY8VBdSCnfg8BnKMc5WAmDryBvy6o6cM5OjDGJ9kIIW7JQ1z9h2gO2CiWGGsUYD4EKOSFwC99j55HIGkAakRxaKy3yheNsWu83Ec03whRARzHG0AO10akHQvguru84e9mDxNL7Kahp20+Q2wZM9TCG0AER6jIT3AE1gZo5uo9kh6ooj3pQwq9t/RZBVCbMqotrG5aOCusewECmYqXLA3hwzFBhKBIEo6oN/gP2hxeqrP5eh23bvqcCFVkYa23D5zkI55S7rGjhieKlZi3JpkTPQVccq0uA+nOqAbON9+KDn/Wh/q9naFr1gkx19XKz89HlA0F15t/HVuzTCo2IhJ/Neuh86akXGXeNthljhAK2P66Cja11j6qqPMA0nDJHDCvFdIZKbaAIK6hwQQO4AquNibuNM7bQj3nYGN38EPt99NIpujx2+Qlxgny+syINnrtokREgjkBhPrWmQQIDgYR1oLKYgqCQetCkbd4iNA+YQuJTiGFHeqAmUBhm7IGYzRoeVQ1BsNSDTiZNs4EUsUHVDNb1ZghxB9NxA8CS09IDAVvEuMmJs3bSg3yIe1Bax+X/UU1+X6cc5alHfXKkrgfHiJ+JazH5HPqPrFmgJ3pawTnPps1pLftxF3EPWF38kf5CCjZ/CzAAhbuFTZwwFTQAAAAASUVORK5CYII=") 50% 50% no-repeat #fff;background-size:10px 10px;border-radius:10px;box-shadow:0 0 0 1px #0003,0 0 1px 0 #0000001a;cursor:pointer;height:20px;position:absolute;width:20px;z-index:1}.flockapi-spinner{display:none;left:50%;margin:-10px 0 0 -10px;position:absolute;top:50%}.flockapi-spinner,.flockapi-spinner:after{box-sizing:border-box;position:relative}.flockapi-spinner{color:#fff;display:block;height:20px;width:20px}.flockapi-spinner:after{animation:flock-ball-clip-rotate .75s linear infinite;background:#0000;border:2px solid;border-bottom:2px solid #0000;border-radius:100%;content:"";display:inline-block;height:100%;width:100%}@keyframes flock-ball-clip-rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.flockapi-display_block{display:block;transition:.2s linear;transition-property:left,top,transform,opacity}.flockapi-show{display:block;opacity:1}.flockapi-show.flockapi-wrapper_popup{transform:scale(1)}.flockapi-wrapper iframe{left:0;position:absolute;top:0}.flockapi-insular-wrapper{display:none;overflow:hidden;visibility:hidden}.flockapi-insular-wrapper[data-widget-type=embedded]{position:static}.flockapi-insular-wrapper[data-widget-type=fixed]{position:fixed}.flockapi-insular-wrapper[data-widget-type=popup]{-webkit-overflow-scrolling:touch;background:#000c;bottom:0;height:auto;left:0;overflow-x:auto;overflow-y:auto;position:fixed;right:0;top:0;width:auto;z-index:1000}.flockapi-insular-wrapper[data-widget-type=popup] .flockapi-insular-widget{margin-left:auto;margin-right:auto}.flockapi-insular-wrapper.flockapi-show{display:block;visibility:visible}.flockapi-insular-widget{display:block}'),document.getElementsByTagName("head")[0].appendChild(d);const h=(0,t.fr)()?Dn:On;return function(...e){const o=e.map((e=>{const[t,...i]=e;return r(t,...i)})),a=e=>o.find((t=>t.factory===e));o.forEach((e=>{e.edges=(0,t.oA)(e.params.map(a)),e._edges=s(e.edges)}));const c=r((()=>Promise.resolve("main node"))),u=e=>o.every((t=>-1===t._edges.indexOf(e))),l=[],d=o.filter((e=>u(e)));for(c.edges=s(d);d.length;){const e=d.pop();l.push(e);let t=e._edges.length;for(;t--;){const i=e._edges[t];e._edges.pop(),u(i)&&d.push(i)}}if(o.find((e=>e._edges&&e._edges.length>0)))return Promise.reject(new Error("Cycles found"));const h=[],p=e=>{const{factory:t,params:n}=e;let r,s=Promise.resolve(null);return e.edges.forEach((e=>{s=s.then((()=>p(e)))})),s.then((()=>{if(null!=e.instance)return e.instance;const s=n.map((e=>{const t=a(e);return null!=t&&null!=t.instance?t.instance:e}));return r=setTimeout((()=>{i.error(new Error("Node init timeout"),{factory:t.toString().substring(0,100)})}),6e4),t(...s)})).then((t=>{r&&clearTimeout(r),e.instance=t,h.push(t)}))};return p(c).then((()=>{const e=e=>{const t=a(e);return null==t?null:t.instance};return e[n]=()=>h.reduce(((e,t)=>e.then((()=>t.destroy?t.destroy():null))),Promise.resolve()),e}))}([vi],[mi.factory],[ke,{siteId:l}],[cn,ke,{siteId:l}],[Sn,cn,mi.factory,{siteId:l},o],[Ve,ke,{siteId:l}],[Vi,Ve,ke,Sn,{siteId:l}],[Rt,Vi,{siteId:l},cn],[bi,Rt],[ti,Ve,Rt,{siteId:l},Vi],[ci,Ve,Vi],[hi.factory,Ve,Vi],[fi,Ve,ci,vi,bi,ti,Vi],[Ot.Z,Tt,ti,window,o],[Tt,Rt,ti,bi,Ei,cn,Vi],[Vn,cn],[qt,Ve,ti,fi,ci,hi.factory,mi.factory,vi,Ei,Rt,bi,Vi,{siteId:l},cn,kn,Vn],[Ei,ci,fi,vi,ti,Vi,Vn],[kn,{siteId:l},o,Vi,cn,h,Ve],[h,Ve,Vi,cn,{siteId:l},ti]).then((i=>{const n=i(Ve),r=i(Rt),s=i(ti),a=i(Tt),c=i(qt),l=i(Vi),d=i(vi),h=i(ke),p=i(cn),m=i(bi),g=i(mi.factory);if(null!=n&&null!=r&&null!=s&&null!=a&&null!=c&&null!=l&&null!=d&&null!=p&&null!=m){for(function(e,i){const n=(0,t.ak)("fl_checkpoint",window.location.href),r="true"===sessionStorage.getItem(Fn),s=()=>{i.sendCheckpointId(n),sessionStorage.setItem(Fn,"true")};!r&&n&&(e.isActionAvailable(ve.GET_COOKIE_VALUE)?e.getCookieValue(Ye.globalSessionId).then((e=>{e||s()})):s())}(h,p),function(e,t,i){e&&e.isActionAvailable(ve.GET_GLOBAL_SESSION_ID)&&(!i||!i.isExternalTrackingDisabled())&&e.getGlobalSessionId().then((e=>!!e&&new Ee(e,t).track()),(e=>(Se.error(e),!1)))}(h,n,l),function(e,i){const n=i.getPrecheckoutTestSettings();let r=JSON.parse(localStorage.getItem(xe)||"{}");if(!(null==i?void 0:i.isProductEnabled("precheckout")))return void Ne.warn("precheckout disabled");if(Boolean((0,t.ak)("flocktory-preview-id",window.location.href)))return;const s=i.getTrackingSettings(),o=(null==n?void 0:n.id)||(null==r?void 0:r.id),a=o?De(e,o,s):null;(null==n?void 0:n.id)&&"string"==typeof(null==n?void 0:n.label)?(Ne.info(`Precheckout test id ${null==n?void 0:n.id}: variation "${null==n?void 0:n.label}"`),(null==r?void 0:r.id)!==(null==n?void 0:n.id)?(null==a||a.track(null==n?void 0:n.label,!0),Ne.info("test start logged"),r={id:null==n?void 0:n.id,variation:null==n?void 0:n.label},localStorage.setItem(xe,JSON.stringify(r))):(null==r?void 0:r.variation)!==(null==n?void 0:n.label)&&(null==a||a.track("mismatch_original_group",!0),Ne.info("test mismatch logged"))):(null==r?void 0:r.id)&&(localStorage.removeItem(xe),null==a||a.track("stop-test-flocktory-precheckout",!0),Ne.info("test stop logged"))}(r,l),c.reset(),Object.assign(o,a);o.length;)Mn(o.shift(),a);u.forEach((e=>{try{e()}catch(e){Un.warn("Wrong ready callback")}})),o.ready=e=>setTimeout(e,1),o.push=e=>Mn(e,a),r.trackPageView(),l.update(s.user),s.on("add-user",(e=>{Object.keys(e).length&&c.update(e)})),n.get("precheckoutClosed"),o.getSubscriptionStatus=p.getSubscriptionStatus,function(t,i,n){t.__dev__clear=()=>i.clear(),t.__dev__setLogLevel=t=>{let i;e.Z.setLevel(t||e.p.ALL),e.Z.enable();try{i=JSON.parse(window.localStorage.getItem("flocktoryDebug"))}catch(e){}i=i||{},i.log=i.log||{},i.log.level=t||e.p.ALL;try{localStorage.setItem("flocktoryDebug",JSON.stringify(i))}catch(e){}},t.__dev__disableLog=()=>{e.Z.disable(),t.__dev__clear()},t.__version="4bc0cbe35728a16069fb400e9b0da125e6cd8ad6",t.__getState=n.dump}(o,n,l),d.events.on("locationchange",(()=>{l.updateViewId()})),o.reInit=()=>{Un.warn("reInit"),s.resetItem(),s.resetCategory();const e={precheckoutWrapper:".flocktory-widget-overlay",postcheckoutWrapper:".flockapi-overlay",exchangeWrapper:".flockapi-overlay",spanWrapper:".fl-embedded-wrapper",customWrapper:".fl-custom-wrapper"},t=e=>{const t=document.querySelectorAll(e);[].forEach.call(t,(e=>e.remove()))};l.updateViewId(),r.trackPageView(),t(e.spanWrapper),t(e.customWrapper),t([e.exchangeWrapper,e.postcheckoutWrapper,e.precheckoutWrapper].join(",")),l.resetCampaignsShownIds();const i={email:s.user.email,name:s.user.name};m.emit("clean"),c.update(i,!0)},jn.info("emit loaderReady event",performance.now()),m.emit("loaderReady"),g.on(mi.EVENTS.EXPIRED,(()=>{l.update(s.user,!0)}))}}))}(rn,{siteId:zn}).then((()=>{$n.info("System ready. Version: 4bc0cbe35728a16069fb400e9b0da125e6cd8ad6"),Wn.info("System ready",performance.now())})).catch((e=>{$n.error(e,"Loader error")}))):$n.warn("Can't init flocktory in this browser"):$n.warn("No site id")})()})();